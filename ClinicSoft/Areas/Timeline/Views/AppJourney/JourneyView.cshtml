@model BusinessEntities.Appointment.SearchAppJourney
<style>
    #ajSize {
        max-width: 800px !important;
    }
    
</style>
<div class="modal-header py-3 px-4">
    <h5 class="modal-title text-primary font-weight-semibold" id="exampleModalLongTitle">Patient Appointment Journey</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="btnSearchClose">
        <span aria-hidden="true">&times;</span>
    </button>
</div>
<div class="modal-body p-4">
    <div class="row">
        <div class="col-xl-12">
            <div class="card custom-card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-12 mx-auto">
                            <div class="checkout-steps wrapper">
                                <div id="divBookStage">
                                    <div class="text-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-calendar2-check mb-2" viewBox="0 0 16 16" style="color: #af556e">
                                            <path d="M10.854 8.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708 0z" />
                                            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H2z" />
                                            <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V4z" />
                                        </svg>
                                    </div>
                                    <div class="">
                                        <h4 class="text-center mb-4 font-weight-semibold" style="color: #af556e;">Now Patient is in Booking Stage...</h4>
                                    </div>
                                </div>
                                <div id="divFrontDeskStage">
                                    <div class="text-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-pc-display mb-2" viewBox="0 0 16 16" style="color: #6b55af">
                                            <path d="M8 1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V1Zm1 13.5a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0Zm2 0a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0ZM9.5 1a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5ZM9 3.5a.5.5 0 0 0 .5.5h5a.5.5 0 0 0 0-1h-5a.5.5 0 0 0-.5.5ZM1.5 2A1.5 1.5 0 0 0 0 3.5v7A1.5 1.5 0 0 0 1.5 12H6v2h-.5a.5.5 0 0 0 0 1H7v-4H1.5a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5H7V2H1.5Z" />
                                        </svg>
                                    </div>
                                    <div class="">
                                        <h4 class="text-center mb-4 font-weight-semibold" style="color: #6b55af">Now Patient is in Front Desk...</h4>
                                    </div>
                                </div>
                                <div id="divNurseStationStage">
                                    <div class="text-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-clipboard2-heart mb-2" viewBox="0 0 16 16" style="color: #2d41ce">
                                            <path d="M10.058.501a.501.501 0 0 0-.5-.501h-2.98c-.276 0-.5.225-.5.501A.499.499 0 0 1 5.582 1a.497.497 0 0 0-.497.497V2a.5.5 0 0 0 .5.5h4.968a.5.5 0 0 0 .5-.5v-.503A.497.497 0 0 0 10.555 1a.499.499 0 0 1-.497-.499Z" />
                                            <path d="M3.605 2a.5.5 0 0 0-.5.5v12a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5v-12a.5.5 0 0 0-.5-.5h-.5a.5.5 0 0 1 0-1h.5a1.5 1.5 0 0 1 1.5 1.5v12a1.5 1.5 0 0 1-1.5 1.5h-9a1.5 1.5 0 0 1-1.5-1.5v-12a1.5 1.5 0 0 1 1.5-1.5h.5a.5.5 0 0 1 0 1h-.5Z" />
                                            <path d="M8.068 6.482c1.656-1.673 5.795 1.254 0 5.018-5.795-3.764-1.656-6.69 0-5.018Z" />
                                        </svg>
                                    </div>
                                    <div class="">
                                        <h4 class="text-center mb-4 font-weight-semibold" style="color: #2d41ce">Now Patient is in Nurse Station...</h4>
                                    </div>
                                </div>
                                <div id="divDoctorStationStage">
                                    <div class="text-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-clipboard2-plus mb-2" viewBox="0 0 16 16" style="color: #c10d0d;">
                                            <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5h3Z" />
                                            <path d="M3 2.5a.5.5 0 0 1 .5-.5H4a.5.5 0 0 0 0-1h-.5A1.5 1.5 0 0 0 2 2.5v12A1.5 1.5 0 0 0 3.5 16h9a1.5 1.5 0 0 0 1.5-1.5v-12A1.5 1.5 0 0 0 12.5 1H12a.5.5 0 0 0 0 1h.5a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5v-12Z" />
                                            <path d="M8.5 6.5a.5.5 0 0 0-1 0V8H6a.5.5 0 0 0 0 1h1.5v1.5a.5.5 0 0 0 1 0V9H10a.5.5 0 0 0 0-1H8.5V6.5Z" />
                                        </svg>
                                    </div>
                                    <div class="">
                                        <h4 class="text-center mb-4 font-weight-semibold" style="color: #c10d0d;">Now Patient is in Doctors Station...</h4>
                                    </div>
                                </div>
                                <div id="divBillingStage">
                                    <div class="text-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-cash-coin mb-2" viewBox="0 0 16 16" style="color: #7c0859">
                                            <path fill-rule="evenodd" d="M11 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm5-4a5 5 0 1 1-10 0 5 5 0 0 1 10 0z" />
                                            <path d="M9.438 11.944c.047.596.518 1.06 1.363 1.116v.44h.375v-.443c.875-.061 1.386-.529 1.386-1.207 0-.618-.39-.936-1.09-1.1l-.296-.07v-1.2c.376.043.614.248.671.532h.658c-.047-.575-.54-1.024-1.329-1.073V8.5h-.375v.45c-.747.073-1.255.522-1.255 1.158 0 .562.378.92 1.007 1.066l.248.061v1.272c-.384-.058-.639-.27-.696-.563h-.668zm1.36-1.354c-.369-.085-.569-.26-.569-.522 0-.294.216-.514.572-.578v1.1h-.003zm.432.746c.449.104.655.272.655.569 0 .339-.257.571-.709.614v-1.195l.054.012z" />
                                            <path d="M1 0a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h4.083c.058-.344.145-.678.258-1H3a2 2 0 0 0-2-2V3a2 2 0 0 0 2-2h10a2 2 0 0 0 2 2v3.528c.38.34.717.728 1 1.154V1a1 1 0 0 0-1-1H1z" />
                                            <path d="M9.998 5.083 10 5a2 2 0 1 0-3.132 1.65 5.982 5.982 0 0 1 3.13-1.567z" />
                                        </svg>
                                    </div>
                                    <div class="">
                                        <h4 class="text-center mb-4 font-weight-semibold" style="color: #7c0859">Now Patient is in Billing &amp; Invoice...</h4>
                                    </div>
                                </div>
                                <div class="border p-4 mb-2 mt-2" id="divPatInfo"> </div>
                                <div id="checkoutsteps">
                                    <h4>Booking</h4>
                                    <section>
                                        <ul class="list-group" id="ulBookStage">
                                        </ul>
                                    </section>
                                    <h4>Front Desk</h4>
                                    <section>
                                        <ul class="list-group" id="ulFrontDeskStage">
                                        </ul>
                                    </section>
                                    <h4>Nurse Station</h4>
                                    <section>
                                        <ul class="list-group" id="ulNurseStationStage">
                                        </ul>
                                    </section>
                                    <h4>Doctor Station</h4>
                                    <section>
                                        <ul class="list-group" id="ulDoctorStationStage">
                                        </ul>
                                    </section>
                                    <h4>Invoice</h4>
                                    <section>
                                        <ul class="list-group" id="ulBillingStage">
                                        </ul>
                                    </section>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/assets/plugins/jquery-steps/jquery.steps.min.js"></script>
<script>
    $(function () {
        $("#checkoutsteps").steps({
            headerTag: "h4",
            bodyTag: "section",
            transitionEffect: "fade",
            enableAllSteps: true,
            enableFinishButton: false,
            enablePagination: false,
            transitionEffectSpeed: 500
        });
        $('#checkoutsteps .steps').prepend("<div class='checkoutline'></div>");

        $.ajax({
            url: '@Url.Action("GetJourneyData", new { area = "Timeline" })?appId=' + @Model.appId,
            type: "GET",
            dataType: "json",
            async: false,
            success: function (response) {
                if (parseInt(response.CurrentIndex) === 0 || parseInt(response.CurrentIndex) === 1) {
                    $("#checkoutsteps-t-0").get(0).click();
                    $("#checkoutsteps-t-0 .number").attr("style", "background-color: orange;color: white;");
                    $("#checkoutsteps-t-1 .number").attr("style", "background-color: #707070;color: white;");
                    $("#checkoutsteps-t-2 .number").attr("style", "background-color: #707070;color: white;");
                    $("#checkoutsteps-t-3 .number").attr("style", "background-color: #707070;color: white;");
                    $("#checkoutsteps-t-4 .number").attr("style", "background-color: #707070;color: white;");

                    $("#divBookStage").show();
                    $("#divFrontDeskStage").hide();
                    $("#divNurseStationStage").hide();
                    $("#divDoctorStationStage").hide();
                    $("#divBillingStage").hide();
                }
                else if (parseInt(response.CurrentIndex) === 2) {
                    $("#checkoutsteps-t-1").get(0).click();
                    $("#checkoutsteps-t-0 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-1 .number").attr("style", "background-color: orange;color: white;");
                    $("#checkoutsteps-t-2 .number").attr("style", "background-color: #707070;color: white;");
                    $("#checkoutsteps-t-3 .number").attr("style", "background-color: #707070;color: white;");
                    $("#checkoutsteps-t-4 .number").attr("style", "background-color: #707070;color: white;");

                    $("#divBookStage").hide();
                    $("#divFrontDeskStage").show();
                    $("#divNurseStationStage").hide();
                    $("#divDoctorStationStage").hide();
                    $("#divBillingStage").hide();
                }
                else if (parseInt(response.CurrentIndex) === 3) {
                    $("#checkoutsteps-t-2").get(0).click();
                    $("#checkoutsteps-t-0 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-1 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-2 .number").attr("style", "background-color: orange;color: white;");
                    $("#checkoutsteps-t-3 .number").attr("style", "background-color: #707070;color: white;");
                    $("#checkoutsteps-t-4 .number").attr("style", "background-color: #707070;color: white;");

                    $("#divBookStage").hide();
                    $("#divFrontDeskStage").hide();
                    $("#divNurseStationStage").show();
                    $("#divDoctorStationStage").hide();
                    $("#divBillingStage").hide();
                }
                else if (parseInt(response.CurrentIndex) === 4) {
                    $("#checkoutsteps-t-3").get(0).click();
                    $("#checkoutsteps-t-0 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-1 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-2 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-3 .number").attr("style", "background-color: orange;color: white;");
                    $("#checkoutsteps-t-4 .number").attr("style", "background-color: #707070;color: white;");

                    $("#divBookStage").hide();
                    $("#divFrontDeskStage").hide();
                    $("#divNurseStationStage").hide();
                    $("#divDoctorStationStage").show();
                    $("#divBillingStage").hide();
                }
                else if (parseInt(response.CurrentIndex) === 5) {
                    $("#checkoutsteps-t-4").get(0).click();
                    $("#checkoutsteps-t-0 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-1 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-2 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-3 .number").attr("style", "background-color: green;color: white;");
                    $("#checkoutsteps-t-4 .number").attr("style", "background-color: orange;color: white;");

                    $("#divBookStage").hide();
                    $("#divFrontDeskStage").hide();
                    $("#divNurseStationStage").hide();
                    $("#divDoctorStationStage").hide();
                    $("#divBillingStage").show();
                }

                var bookStageHtml = '';
                $.each(response.BookStage, function (j) {
                    if (response.BookStage[j]["isCompleted"]) {
                        bookStageHtml += '<li class="list-group-item text-info">' + response.BookStage[j]["SubCategoryName"] + '<span class="badgetext badge bg-info rounded-pill">' + moment(response.BookStage[j]["TimeStamp"]).format("YYYY-MM-DD HH:mm:ss") + '</span></li>';
                    }
                    else {
                        bookStageHtml += '<li class="list-group-item text-dark">' + response.BookStage[j]["SubCategoryName"] + '<span class="badgetext badge badge-default rounded-pill"><small>Not yet Start<small></span></li>';
                    }
                });
                $("#ulBookStage").html(bookStageHtml);

                var frontDeskStageHtml = '';
                $.each(response.FrontDeskStage, function (j) {
                    if (response.FrontDeskStage[j]["isCompleted"]) {
                        frontDeskStageHtml += '<li class="list-group-item text-info">' + response.FrontDeskStage[j]["SubCategoryName"] + '<span class="badgetext badge bg-info rounded-pill">' + moment(response.FrontDeskStage[j]["TimeStamp"]).format("YYYY-MM-DD HH:mm:ss") + '</span></li>';
                    }
                    else {
                        frontDeskStageHtml += '<li class="list-group-item text-dark">' + response.FrontDeskStage[j]["SubCategoryName"] + '<span class="badgetext badge badge-default rounded-pill"><small>Not yet Start<small></span></li>';
                    }
                });
                $("#ulFrontDeskStage").html(frontDeskStageHtml);

                var nurseStationStageHtml = '';
                $.each(response.NurseStationStage, function (j) {
                    if (response.NurseStationStage[j]["isCompleted"]) {
                        nurseStationStageHtml += '<li class="list-group-item text-info">' + response.NurseStationStage[j]["SubCategoryName"] + '<span class="badgetext badge bg-info rounded-pill">' + moment(response.NurseStationStage[j]["TimeStamp"]).format("YYYY-MM-DD HH:mm:ss") + '</span></li>';
                    }
                    else {
                        nurseStationStageHtml += '<li class="list-group-item text-dark">' + response.NurseStationStage[j]["SubCategoryName"] + '<span class="badgetext badge badge-default rounded-pill"><small>Not yet Start<small></span></li>';
                    }
                });
                $("#ulNurseStationStage").html(nurseStationStageHtml);

                var doctorStationStageHtml = '';
                $.each(response.DoctorStationStage, function (j) {
                    if (response.DoctorStationStage[j]["isCompleted"]) {
                        doctorStationStageHtml += '<li class="list-group-item text-info">' + response.DoctorStationStage[j]["SubCategoryName"] + '<span class="badgetext badge bg-info rounded-pill">' + moment(response.DoctorStationStage[j]["TimeStamp"]).format("YYYY-MM-DD HH:mm:ss") + '</span></li>';
                    }
                    else {
                        doctorStationStageHtml += '<li class="list-group-item text-dark">' + response.DoctorStationStage[j]["SubCategoryName"] + '<span class="badgetext badge badge-default rounded-pill"><small>Not yet Start<small></span></li>';
                    }
                });
                $("#ulDoctorStationStage").html(doctorStationStageHtml);

                var billingStageHtml = '';
                $.each(response.BillingStage, function (j) {
                    if (response.BillingStage[j]["isCompleted"]) {
                        billingStageHtml += '<li class="list-group-item text-info">' + response.BillingStage[j]["SubCategoryName"] + '<span class="badgetext badge bg-info rounded-pill">' + moment(response.BillingStage[j]["TimeStamp"]).format("YYYY-MM-DD HH:mm:ss") + '</span></li>';
                    }
                    else {
                        billingStageHtml += '<li class="list-group-item text-dark">' + response.BillingStage[j]["SubCategoryName"] + '<span class="badgetext badge badge-default rounded-pill"><small>Not yet Start<small></span></li>';
                    }
                });
                $("#ulBillingStage").html(billingStageHtml);

                var patient_info = '<div class="media d-block d-sm-flex">' +
                    '<div class="media-body pt-2 mb-sm-0">' +
                    '<h5 class="mg-b-5 tx-inverse tx-15 font-weight-semibold text-primary">' +
                    response.PatientName +
                    '</h5>' +
                    '<div class="tag tag-danger me-2">' +
                    response.MRN +
                    '<span class="tag-addon"><i class="fa fa-hashtag"></i></span>' +
                    '</div>' +
                    '<div class="tag tag-blue me-2">' +
                    response.Mobile +
                    '<span class="tag-addon"><i class="fa fa-mobile-phone"></i></span>' +
                    '</div>' +
                    '<div class="tag tag-orange me-2">' +
                    response.DOB +
                    '<span class="tag-addon"><i class="fa fa-calendar"></i></span>' +
                    '</div>' +
                    '<div class="tag tag-indigo me-2">';

                if (response.Gender.startsWith("F") || response.Gender.startsWith("f")) {
                    patient_info += 'Female <span class="tag-addon"><i class="fa fa-female"></i></span>';
                }
                else {
                    patient_info += 'Male <span class="tag-addon"><i class="fa fa-male"></i></span>';
                }

                patient_info += '</div>' +
                    '</div>' +
                    '<img alt = "" class="avatar avatar-xl brround ms-3" src = "' + response.Photo + '" > ' +
                    '</div>';

                $("#divPatInfo").html(patient_info);

            },
            error: function (xhr) {
                console.log(xhr);
            }
        });
    });

    $("#btnSearchClose").click(function () {
        $('#search_journey').val(null).trigger('change');
    });
</script>