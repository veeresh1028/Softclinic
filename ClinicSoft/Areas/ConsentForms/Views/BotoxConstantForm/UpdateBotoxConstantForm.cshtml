@using System.Linq;
@using System.Security.Claims;
@using BusinessEntities;
@model BusinessEntities.ConsentForms.BotoxConstantForm

@{
    var claims = ClaimsPrincipal.Current.Identities.First().Claims.ToList();
    var emp_designation = claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value).SingleOrDefault();
    EMRInfo emr = (EMRInfo)TempData["emr_data"];
    TempData.Keep("emr_data");
}
<form id="form_BotoxConstantFormEdit" autocomplete="off" name="BotoxConstantForm" ondrop="return false;" onpaste="return false;" oncut="return false;">
    @Html.AntiForgeryToken()
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <div class="border">
                <div class="col-sm-12 col-md-12 col-lg-12">
                    <div class="row mt-2">
                        <div class="col-sm-12 col-md-6 col-lg-2 mb-2">
                            <div class="form-group mb-3"><label class="form-label text-black text-align-left"> Patient Name</label></div>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-4">
                            <label class="form-label text-red text-left text-capitalize">@emr.pat_name</label>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-2 mb-2">
                            <div class="form-group mb-3"><label class="form-label text-black"> Emirates ID</label></div>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-4">
                            <label class="form-label text-red text-left">@emr.pat_emirateid</label>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2 mb-2">
                            <div class="form-group mb-3 text-align-left"><label class="form-label text-black ">File No</label></div>
                        </div>
                        <div class="col-sm-12 col-md-4 col-lg-2">
                            <label class="form-label text-red text-left">@emr.pat_code</label>
                        </div>
                        <div class="col-sm-12 col-md-2 col-lg-2">
                            <div class="form-group mb-3"><label class="form-label text-black"> DOB</label></div>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2">
                            <label class="form-label text-red text-left">@emr.pat_dob</label>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2 mb-2">
                            <div class="form-group mb-3"><label class="form-label text-black"> Nationality</label></div>
                        </div>
                        <div class="col-sm-12 col-md-4 col-lg-2">
                            <label class="form-label text-red text-left">@emr.pat_nationality</label>
                        </div>
                        <div class="col-sm-12 col-md-2 col-lg-2">
                            <div class="form-group mb-3"><label class="form-label text-black">Gender</label></div>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2">
                            <label class="form-label text-red text-left">@emr.pat_gender</label>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2">
                            <div class="form-group mb-3"><label class="form-label text-black">Doctor's Name</label></div>
                        </div>
                        <div class="col-sm-12 col-md-4 col-lg-2">
                            <label class="form-label text-red text-left">@emr.doc_name</label>
                        </div>
                        <div class="col-sm-12 col-md-2 col-lg-2">
                            <div class="form-group mb-3"><label class="form-label text-black">Date</label></div>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2">
                            <label class="form-label text-red text-left">@emr.app_fdate</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row mb-5 mt-5 col-sm-12 col-md-12 col-lg-12 text-justify">
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2 font-weight-semibold">Botulinum Toxin Informed Consent (Upper Face)</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2 font-weight-semibold">
            Motivations and Expectations @Html.TextAreaFor(m => m.bcf_1, new { @class = "form-control", @id = "ubcf_1" })
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2 font-weight-semibold">Aim of Treatment:</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">The aim of this treatment is to significantly reduce the movement of the muscles causing expression lines, thus improving the appearance of such lines. This clinic uses(Insert Brand)</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2 font-weight-semibold">
            Common Side Effects Associated with the Injections Include;
        </div>
        <div class="col-sm-12 col-md-12 col-lg-6 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Pain or stinging sensation when the injection is performed</li>
                <li class="listunorder" style="border: none;">Localised swelling, redness, tenderness</li>
                <li class="listunorder" style="border: none;">Bleeding at the sites of injection</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-6 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Bruising</li>
                <li class="listunorder" style="border: none;">Numbness or itching of the area following injection</li>
                <li class="listunorder" style="border: none;">Headache</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">The above usually resolve spontaneously within hours or days, but may persist for longer.</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Asymmetry of expression - Perfect symmetry may not be achievable; that caused by the treatment, can often be corrected at your review appointment.</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2 font-weight-semibold">Common side effects associated with treatment with botulinum toxin to the upper face.</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-1 mt-1">1%-10% risk</div>
        <div class="col-sm-12 col-md-12 col-lg-7 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Eye lid ptosis (a drooping or heaviness of the eyelid, one or both), brow ptosis (heaviness and or lowering of the brow).</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-5 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Facial pain</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-1 mt-1 font-weight-semibold">Uncommon Side effects</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-1 mt-1">1%-10% risk</div>
        <div class="col-sm-12 col-md-12 col-lg-3 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Swelling/ puffiness around the eyes</li>
                <li class="listunorder" style="border: none;">Nausea</li>
                <li class="listunorder" style="border: none;">Anxiety</li>
                <li class="listunorder" style="border: none;">Dry mouth</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-4 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Altered skin sensation, muscle twitching or spasm in the treated area</li>
                <li class="listunorder" style="border: none;">Eye pain, dry eyes, tearing, sensitivity to light, blurred vision, strabismus</li>
                <li class="listunorder" style="border: none;">Flu like symptoms</li>
                <li class="listunorder" style="border: none;">Itching or dry skin</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-4 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Muscles not targeted may be effected</li>
                <li class="listunorder" style="border: none;">Infection</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-1 mt-1 font-weight-semibold">Also reported</div>
        <div class="col-sm-12 col-md-12 col-lg-3 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Fever</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-3 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Tinnitus, vertigo</li>
            </ul>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-3 mb-2 mt-2">
            <ul class="list-group">
                <li class="listunorder" style="border: none;">Rash</li>
            </ul>
        </div>

        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2"><span class="text-red">*</span>This list is not exhaustive, you may ask for a copy of the patient information leaflet in the pack, or check the Summary of Product Characteristics on-line.</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">Any adverse reactions usually occur within a few days of treatment. Botulinum toxin effects are not reversible. They are expected to be temporary in nature and usually resolve spontaneously within weeks. Rarely, symptoms may persist for several months.</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2 font-weight-semibold">Expected Outcome </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2 font-weight-semibold">Material Information @Html.TextAreaFor(m => m.bcf_2, new { @class = "form-control", @id = "ubcf_2", @width = "20px" })</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">Successful treatment should prevent or significantly reduce the expressions causing the lines. Treatment may not cause the expression lines themselves to disappear completely.  The expression may not be completely frozen, particularly if extreme effort is exerted to make any expression.  Any decision to increase the dose, or repeat treatment, will be made at the discretion of the practitioner, informed by safety and best practice.</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk1" value="1">
                    <span class="custom-control-label">
                        I understand that though complications are uncommon, they do sometimes occur. It is possible that side effects not described may occur and indeed that a complication not previously reported may occur for the first time.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk2" value="2">
                    <span class="custom-control-label">
                        I understand if I suffer any adverse reactions that are not expected, or concern me, I must contact the clinic.   An appointment will be made for me to be seen.  The clinic cannot take responsibility for complications or results that have not been reported, assessed, documented and managed in a timely fashion.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk3" value="3">
                    <span class="custom-control-label">
                        I understand that whilst results desired and expected have been discussed, outcomes vary between individuals and cannot be guaranteed.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk4" value="4">
                    <span class="custom-control-label">
                        I confirm that the medical health history form has been completed truthfully and I am fully aware that withholding medical information, including history of previous treatment, may be detrimental to the safe and optimal outcome of any treatment administered.  If there are any changes in my medical history, I must inform the practitioner.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk5" value="5">
                    <span class="custom-control-label">
                        I confirm that I have been provided with verbal and written information about this treatment which includes aftercare and follow up advice.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk6" value="6">
                    <span class="custom-control-label">
                        I agree to follow the aftercare advice and understand this reduces risk of adverse reactions and helps ensure optimum results.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk7" value="7">
                    <span class="custom-control-label">
                        I understand information about me will be treated as confidential and access to it restricted in accordance with the Data Protection Act, unless specific permissions given.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk8" value="8">
                    <span class="custom-control-label">
                        I consent to my medical records being shared with appropriate medical professionals
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk9" value="9">
                    <span class="custom-control-label">
                        I understand photographs are taken as part of my medical record.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2 font-weight-semibold">
            On occasion it is helpful to share visual images of our own treatment results.
            I consent to photographs being published for;
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk10" value="10">
                    <span class="custom-control-label">
                        Educational and training purposes with medical professionals
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk11" value="11">
                    <span class="custom-control-label">
                        Educational purposes with selected patients during consultation
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk12" value="12">
                    <span class="custom-control-label">
                        Educational/promotional purposes in the clinics portfolio viewed by selected members of the public
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk13" value="13">
                    <span class="custom-control-label">
                        Educational/promotional purposes on the clinic website
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk14" value="14">
                    <span class="custom-control-label">
                        Educational purposes for selected public events
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk15" value="15">
                    <span class="custom-control-label">
                        I understand that no fee is payable to me or any other person in respect of the material either now or at any time in the future.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk16" value="16">
                    <span class="custom-control-label">
                        I confirm that the purpose for which the material would be used has been explained to me in terms which I have understood.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk17" value="17">
                    <span class="custom-control-label">
                        I have taken the time to read;
                    </span>
                </label>
            </div>


            <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
                <ul class="list-group">
                    <li class="listunorder" style="border: none;">Botulinum Toxin Consent Form</li>
                    <li class="listunorder" style="border: none;">Treatment Information Botulinum Toxin</li>
                    <li class="listunorder" style="border: none;">Clinic Terms and Conditions</li>
                </ul>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ubcf_chk" id="ubcf_chk18" value="18">
                    <span class="custom-control-label">
                        I accept the clinic terms and conditions. I am satisfied treatment with botulinum toxin has been explained comprehensively and that the possible risks and side effects associated with the treatment have been fully discussed and understood. I have taken sufficient time to process and consider the information provided and any questions I had have been answered to my satisfaction, before making a decision to proceed with the agreed treatment plan.
                    </span>
                </label>
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-12 mb-2 mt-2">I have been advised the cost of the treatment will be £ @Html.TextBoxFor(m => m.bcf_3, new { @class = "form-control-sm", @id = "ubcf_3", @width = "20px" }) and accept the terms of payment as per the clinic policy (terms and conditions).</div>
    </div>
    <div class="row mt-2">
        <div class="col-sm-12 col-md-12 col-lg-12 text-center table-responsive">
            <table class="table table-bordered table-condensed">
                <tr>
                    <td colspan="3" class="font-weight-bold text-danger fs-18" width="100%">
                        Sign here, only if all of your questions have been answered to your satisfaction
                    </td>
                </tr>
                <tr>
                    <td width="50%">
                        <div id="upat_sign_box" class="d-none">
                            <img alt="stamp" id="upat_sign" class="avatar avatar-xl bsquare" />
                        </div>
                    </td>
                    <td width="50%">
                        <img alt="stamp" src="@emr.doc_sign" id="doc_sign" class="avatar avatar-xl bsquare" />
                    </td>
                </tr>
                <tr>
                    <td width="50%">
                        <label class="form-label text-red text-left text-capitalize">@emr.pat_name&nbsp;</label>
                        <span class="font-weight-semibold"> Patient Name</span>
                        <br /><br />
                        <label class="form-label text-red text-left" id="upsb_date_patient"></label>
                        <span class="font-weight-semibold">Date</span>
                    </td>
                    <td width="50%">
                        <label class="form-label text-red text-left text-capitalize">@emr.doc_name&nbsp;</label>
                        <span class="font-weight-semibold">Doctor’s Name</span>
                        <br /><br />
                        <label class="form-label text-red text-left" id="ubcf_date_doctor">@Model.bcf_date_modified&nbsp;</label>
                        <span class="font-weight-semibold">Date</span>
                    </td>
                </tr>
                <tr>
                    <td class="font-weight-semibold text-blue" width="50%">
                        Patient Signature
                        <br />
                        <div class="btn-group mr-2">
                            <div class="dropdown">
                                <button type="button" class="btn-sm btn-secondary me-2 mb-2 dropdown-toggle" data-bs-toggle="dropdown">
                                    <i class="fa fa-paint-brush">&nbsp;&nbsp;</i> Patient
                                </button>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" onclick="openSignaturePad('patient')">Tab</a>
                                    <a class="dropdown-item" onclick="openWacomTabSignaturePad('patient')">Wacom Tab</a>
                                </div>
                            </div>
                        </div>
                    </td>
                    <td class="font-weight-semibold text-blue text-center" width="50%">Doctor’s Signature</td>
                </tr>
            </table>
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-sm-12 col-md-12 col-lg-12 text-center">
            <div class="btn-list btn-animation">
                <button type="submit" class="btn btn-warning btn-sm" id="btn_Update">Save Changes</button>
                <button type="button" class="btn btn-outline-dark btn-sm" id="btn_Reset">Reset</button>
                <button type="button" class="btn btn-danger btn-sm" id="btn_DeleteForm">Delete</button>
                <button type="button" class="btn btn-sm btn-outline-success" id="btn_Print"> Download/Print </button>
            </div>
        </div>
    </div>
</form>
<script type="text/javascript">


    $(function () {
        if ("@emp_designation.ToString()" === "Super Administrator") {
            $("#btn_Update").show();
        }
        else {
            if ("@emr.set_emr_lock" == "NoLock") {
                $("#btn_Update").show();
            }
            else {
                if ("@emr.app_ae_date" >= "@emr.today") {
                    $("#btn_Update").show();
                }
                else {
                    $("#btn_Update").hide();
                }
            }
        }
        validate();
        GetCheckedValues();
        GetSignaturename('patient');

    });

         //#region Get CheckedValues
  var GetCheckedValues = function (checknames) {
    var checknames = "@Model.bcf_chk";

      if (checknames !== null) {

          if (checknames != "") {
              var str = "@Model.bcf_chk";
              var myarray = str.split(',');
              for (var i = 0; i < myarray.length; i++) {
                  $('.custom-control-input').each(function () {
                      if (myarray.includes($(this).val())) {
                          $(this).prop("checked", true);
                      }
                  });
              }
              console.log(myarray)


          }
      }
    }
  //#endregion Get CheckedValues

    //#region Update  Click
    $('#btn_Update').on('click', function (e) {
        e.preventDefault();
        if ($("#form_BotoxConstantFormEdit").valid()) {
            console.log($("#bcfId").val());
            $('#btn_Update').removeClass("btn btn-sm btn-success");
            $('#btn_Update').addClass("btn btn-sm btn-success btn-loaders btn-icon");
            $('#btn_Update').html("Updating the Record....");


            var ubcf_chk_ = $.map($(':checkbox[name=ubcf_chk]:checked'), function (n, i) {
                return n.value;
            }).join(',');


            var _dateInsert = {
                "bcfId": 0,
                "bcf_appId": @emr.appId,
                "bcf_chk": ubcf_chk_,
                "bcf_1": $("#ubcf_1").val(),
                "bcf_2": $("#ubcf_2").val(),
                "bcf_3": $("#ubcf_3").val(),
                "__RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val()
            }
            console.log(_dateInsert);

            $.ajax({
                type: "Post",
                url: "@Url.Action("EditBotoxConstantForm", "BotoxConstantForm", new {area = "ConsentForms" })",
                dataType: 'JSON',
                data: _dateInsert,
                success: function (data) {
                    $('#btn_Update').removeClass("btn btn-sm btn-success btn-loaders btn-icon");
                    $('#btn_Update').addClass("btn btn-sm btn-success");
                    $('#btn_Update').html("Save Changes");



                    if (data.isSuccess) {
                        if (data.isEdited) {
                            GetBotoxConstantFormInfo();
                            var alertPlaceholder = document.getElementById("Alert");

                            function alert(e, t) {
                                var l = document.createElement("div");
                                l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" role="alert">' + e +
                                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
                            }
                            alert("<i class='fe fe-check-circle text-white'></i>BotoxConstantForm Updated Successfully!", "success");

                            Timeout();
                            $("#BotoxConstantForm_edit").show();
                            $("#BotoxConstantForm_add").hide();

                        }
                        else {
                            let html = "<div class='col-12 col-sm-12 col-md-6 d-flex justify-content-center'>" +
                                "<div class='alert alert-warning' role='alert'>" +
                                "<button type='button' class='btn-close mr-negative-16' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                                "<strong>Warning.. BotoxConstantForm already Exists..</strong><br/>" +
                                "</div></div>";
                            $("#Alert1").html(html);
                        }
                    }
                    else {
                        let html = "<div class='col-12 col-sm-12 col-md-6 d-flex justify-content-center'>" +
                            "<div class='alert alert-danger' role='alert'>" +
                            "<button type='button' class='btn-close mr-negative-16' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                            "<strong>Validation Error.. Please correct before you submit the form!&nbsp;</strong><br/><ul>";

                        $.each(data.message, function (index, value) {
                            html += "<li><small>" + value + "</small><li>";
                            var elem = $("#" + index);
                            if (elem.hasClass("select2-hidden-accessible")) {
                                $("#select2-" + elem.attr("id") + "-container").parent().addClass('error');
                            }
                            else {
                                $(elem).addClass(" is-invalid");
                            }

                            setTimeout(function () {
                                if (elem.hasClass("select2-hidden-accessible")) {
                                    $("#select2-" + elem.attr("id") + "-container").parent().removeClass('error');
                                }
                                else {
                                    $(elem).removeClass("is-invalid");
                                }
                            }, 5000);
                        });

                        html += "</ul></div></div>";

                        $("#error").html(html);
                    }
                },
                error: function (xhr) {
                    $('#btn_Update').removeClass("btn btn-sm btn-success btn-loaders btn-icon");
                    $('#btn_Update').addClass("btn btn-sm btn-warning");
                    $('#btn_Update').html("Save Changes");
                    Timeout();
                }
            });
        }
        else {
            $('.modal-body').animate({
                scrollTop: ($('.has-error').offset().top - 300)
            }, 2000);
        }

    });
    //#endregion Update Click
    //#region Validation Initialization
    var validate = function () {
        $("#form_BotoxConstantFormEdit").validate({
            rules: {
                bcf_3: {
                    required: true
                },
            },
            messages: {
                bcf_3: {
                    required: "Please Enter Treatment"
                },
            },
            highlight: function (element) {
                var elem = $(element);
                $(element).parent().addClass('has-error');
                //error_timeout(elem.attr("id"));
            },
            unhighlight: function (element) {
                var elem = $(element);
                $(element).parent().removeClass('has-error');
            },
            errorElement: 'span',
            errorClass: 'text-danger fw-bold',
            errorPlacement: function (error, element) {
                var elem = $(element);
                if (element.parent('.input-group').length) {
                    error.insertAfter(element.parent());
                } else {
                    error.insertAfter(element);
                }
            }
        });
    }
    //#endregion
            //#region Delete Click
    $('#btn_DeleteForm').on('click', function (e) {
        e.preventDefault();
        $('#btn_DeleteForm').removeClass("btn btn-success");
        $('#btn_DeleteForm').addClass("btn btn-success btn-loaders btn-icon");
        $('#btn_DeleteForm').html("Deleting the Record....");

        $.ajax({
            url: '@Url.Action("DeleteBotoxConstantForm", "BotoxConstantForm", new { area = "ConsentForms" })?appId=' + @emr.appId,
            type: "POST",
            dataType: 'JSON',
            success: function (data) {
                $('#btn_DeleteForm').removeClass("btn btn-success btn-loaders btn-icon");
                $('#btn_DeleteForm').addClass("btn btn-warning");
                $('#btn_DeleteForm').html("Delete");
                if (data.isAuthorized) {
                    if (data.success) {
                        var alertPlaceholder = document.getElementById("Alert");
                        function alert(e, t) {
                            var l = document.createElement("div");
                            l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" >' + e +
                                '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
                        }
                        alert("<i class='fe fe-check-circle text-white'></i>BotoxConstantForm Deleted Successfully!", "success");
                        clearControls();
                        $("#BotoxConstantForm_edit").hide();
                        $("#BotoxConstantForm_add").show();
                        AddBotoxConstantForm();
                    }
                    else {
                        let html = "<div class='col-12 col-sm-12 col-md-12 d-flex justify-content-center'>" +
                            "<div class='alert alert-warning' role='alert'>" +
                            "<button type='button' class='btn-close mr-negative-16' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                            "<strong>Error!.. Failed to Delete..</strong><br/>" +
                            "</div></div>";
                        $("#error").html(html);
                    }
                }
                else {
                    var alertPlaceholder = document.getElementById("Alert");
                    function alert(e, t) {
                        var l = document.createElement("div");
                        l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" >' + e +
                            '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
                    }
                    alert("<i class='fe fe-check-circle text-white'></i> You do not have Enough Privileges to Delete this Designation!", "Access Denied!");
                }
            },
            error: function (xhr) {
                $('#btn_DeleteForm').removeClass("btn btn-success btn-loaders btn-icon");
                $('#btn_DeleteForm').addClass("btn btn-Delete");
                $('#btn_DeleteForm').html("Delete");
                Timeout();
            }
        })
    });
//#endregion

    //#region Reset
    $('#btn_Reset').on('click', function (e) {
        e.preventDefault();
        clearControls();
    });
    //#endregion Reset

    //#region Clear Controls
    var clearControls = function () {
        $(".form-control").val("");
        $("input[name='ubcf_chk']:checkbox").prop('checked', false);
        $("#upat_sign").attr("src", "");

    }
    //#endregion Clear Controls

        //#region Print
$('#btn_Print').on('click', function (e) {
    e.preventDefault();
    $('#btn_Print').removeClass("btn btn-sm btn-success");
    $('#btn_Print').addClass("btn btn-sm btn-success btn-loaders btn-icon");
    $('#btn_Print').html("Printing the Record....");
    $.ajax({
        type: "Get",
        url: "@Url.Action("PrintPDFConsent", "BotoxConstantForm", new {area = "ConsentForms" })?appId=" + @emr.appId + "&form=BotoxConstantForm",
        dataType: 'JSON',
        success: function (data) {
            if (data.isAuthorized) {
                if (data.success) {
                    window.location.href = data.message.pdfPath
                }
            }
        },
        error: function (xhr) {
            console.log(xhr);
        }
    });
});
//#endregion Print
//#region Wacom Tab Signature
    var openWacomTabSignaturePad = function (id) {
        var _data = {
            "patId": @emr.patId,
            "person": id,
            "form": "BotoxConstantForm",
            "appId": @emr.appId,
            "formname":"BotoxConstantForm",
            "formlink":"",
            "eSign":""
        }
        $.ajax({
            type: "GET",
            url: "@Url.Action("WacomTabSignaturePad", "WacomTabSignaturePad", new { area = "Common" })",
            contentType: "application/json",
            dataType: "html",
            data: _data,
            success: function (response) {
                $("#signature_pad_body").html(response);
                $("#signature_pad").modal("show");
            },
            error: function (xhr) {
                console.log("Error :" + xhr.statusText);
            }
        });
    }
//#endregion
    //#region Signature
    var openSignaturePad = function (id) {
        var _data = {
            "patId": @emr.patId,
            "person": id,
            "form": "BotoxConstantForm",
            "appId": @emr.appId,
            "formname":"BotoxConstantForm",
            "formlink":"",
            "eSign":""
        }
        $.ajax({
            type: "GET",
            url: "@Url.Action("SignaturePad", "SignaturePad", new { area = "Common" })",
            contentType: "application/json",
            dataType: "html",
            data: _data,
            success: function (response) {
                $("#signature_pad_body").html(response);
                $("#signature_pad").modal("show");
            },
            error: function (xhr) {
                console.log("Error :" + xhr.statusText);
            }
        });
    }
    //#endregion Signature

    $('#signature_pad').on('hidden.bs.modal', function () {
        if (localStorage.getItem("sign") != null) {
            GetSignaturename('patient');
           localStorage.removeItem("sign");
        }
    });

       //#region Get Signature
   var GetSignaturename = function  (person) {
       $.ajax({
           url: '@Url.Action("GetSignature", "SignaturePad", new { area = "Common" })?appId=' + @emr.appId + '&person=' + person + '&form=BotoxConstantForm',
           type: "GET",
           dataType: "json",
           async: false,
           success: function (response) {
               console.log(response);
               let sign = response[0].psb_sign;
               if (response[0].person == "patient") {
                   $("#upat_sign_box").removeClass("d-none");
                   $("#upat_sign").attr("src", sign);
               }

           },
           error: function (xhr) {
               console.log(xhr);
               alert(xhr);
           }

       });
   };
   //#endregion Get Signature

    //#region Alert Timeout
    function Timeout() {
        window.setTimeout(function () {
            $(".alert").fadeTo(500, 0).slideUp(500, function () {
                $(this).remove();
            });
        }, 4200);
    }
    //#endregion Alert Timeout
</script>