@using System.Linq;
@using System.Security.Claims;
@using BusinessEntities;
@model BusinessEntities.ConsentForms.LaserHair

@{
    var claims = ClaimsPrincipal.Current.Identities.First().Claims.ToList();
    var emp_designation = claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value).SingleOrDefault();
    EMRInfo emr = (EMRInfo)TempData["emr_data"];
    TempData.Keep("emr_data");
}
<form id="form_LaserHair" autocomplete="off" name="LaserHair" ondrop="return false;" onpaste="return false;" oncut="return false;">
    @Html.AntiForgeryToken()
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <div class="border">
                <div class="col-sm-12 col-md-12 col-lg-12">
                    <div class="row mt-2">
                        <div class="col-sm-12 col-md-6 col-lg-2 mb-2">
                            <div class="form-group mb-3"><label class="form-label text-black text-align-left"> Patient Name</label></div>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-4">
                            <label class="form-label text-red text-left text-capitalize">@emr.pat_name</label>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-2 mb-2">
                            <div class="form-group mb-3"><label class="form-label text-black"> Emirates ID</label></div>
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-4">
                            <label class="form-label text-red text-left">@emr.pat_emirateid</label>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2 mb-2">
                            <div class="form-group mb-3 text-align-left"><label class="form-label text-black ">File No</label></div>
                        </div>
                        <div class="col-sm-12 col-md-4 col-lg-2">
                            <label class="form-label text-red text-left">@emr.pat_code</label>
                        </div>
                        <div class="col-sm-12 col-md-2 col-lg-2">
                            <div class="form-group mb-3"><label class="form-label text-black"> DOB</label></div>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2">
                            <label class="form-label text-red text-left">@emr.pat_dob</label>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2 mb-2">
                            <div class="form-group mb-3"><label class="form-label text-black"> Nationality</label></div>
                        </div>
                        <div class="col-sm-12 col-md-4 col-lg-2">
                            <label class="form-label text-red text-left">@emr.pat_nationality</label>
                        </div>
                        <div class="col-sm-12 col-md-2 col-lg-2">
                            <div class="form-group mb-3"><label class="form-label text-black">Gender</label></div>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2">
                            <label class="form-label text-red text-left">@emr.pat_gender</label>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2">
                            <div class="form-group mb-3"><label class="form-label text-black">Doctor's Name</label></div>
                        </div>
                        <div class="col-sm-12 col-md-4 col-lg-2">
                            <label class="form-label text-red text-left">@emr.doc_name</label>
                        </div>
                        <div class="col-sm-12 col-md-2 col-lg-2">
                            <div class="form-group mb-3"><label class="form-label text-black">Date</label></div>
                        </div>
                        <div class="col-sm-12 col-md-3 col-lg-2">
                            <label class="form-label text-red text-left">@emr.app_fdate</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-5 mt-5 text-justify col-sm-12 col-md-12 col-lg-12">
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_11" value="1">
                        <span class="custom-control-label">
                            I understand the purpose of this treatment is to reduce or eliminate unwanted hair.  I understand that the results from the treatment vary with each individual.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>
                    أتفهم أن الغرض من هذا العلاج هو تقليل أو إزالة الشعر غير المرغوب فيه. أنا أفهم أن نتائج العلاج تختلف من شخص لآخر.
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_12" value="2">
                        <span class="custom-control-label">
                            I understand that the laser produces a focused beam of light that generates a wavelength of energy that is selectively absorbed by the pigment in the hair follicle.  Everyone in the treatment room, including myself, will wear protective eyewear to prevent eye damage from this intense light
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>
                    أفهم أن الليزر ينتج شعاعًا مركّزًا من الضوء يولد طولًا موجيًا من الطاقة يتم امتصاصه بشكل انتقائي بواسطة الصبغة في بصيلات الشعر. كل شخص في غرفة العلاج ، بمن فيهم أنا ، سيرتدي نظارات واقية لمنع تلف العين من هذا الضوء الشديد
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_13" value="3">
                        <span class="custom-control-label">
                            I understand the sensation of the laser is uncomfortable and may feel like a pinprick for a few seconds and that a sensation of heat may last for a few hours.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>
                    أوافق أنا على ان هذه المعالجة قد تحتاج لعدة جلسات و ذلك يعتمد على المكان المعالج و قد يتراوح ذلك بين 5-7 جلسات علاجية وسطيا
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_14" value="4">
                        <span class="custom-control-label">
                            I understand that clinical results may vary depending on individual factors, including medical history, skin and hair type, patient compliance with pre/post treatment instructions, and individual response treatment.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>
                    أوافق أنا أن هنالك احتمال حدوث بعض البقع تتفاوت درجتها مابين الفاتحة الى الغامقة في المنطقة المعالجة ، وفي الاغلب ليست دائمة و تزول مع الوقت وقد تحتاج الى بعض العلاجات لمعالجتها
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_15" value="5">
                        <span class="custom-control-label">
                            I understand that multiple treatments may be necessary.   Depending on the area being treated, treatments will be repeated at 4-6 week intervals.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>
                    وأنا أفهم أن الليزر هو شعاع مركز من الضوء الذي يولد موجة من الطاقة التي
                    يتم امتصاصها بشكل انتقائي من قبل الصباغ في بصيلات الشعر. وسيكون على الجميع في غرفة العلاج، بما في ذلك نفسي،ارتداء النظارات الواقية لمنع الأضرار التي تصيب العين من هذا الضوء المكثف .
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_16" value="6">
                        <span class="custom-control-label">
                            I understand that I am to avoid sun exposure, tanning beds, and self-tanners a minimum of 6 weeks prior to treatment.  If I am obviously tanned or sunburned, I realize I will not be treated with the hair removal laser.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>
                    أنا أفهم أن  الإحساس  بالليزر غير مريح وربما  أشعر بوخز لبضع ثوان، و حرارة قد
                    تستمر لبضع ساعات
                    .
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_17" value="7">
                        <span class="custom-control-label">
                            I understand that the area should be gently cleansed and I will avoid picking or scratching the area. A daily sunscreen SPF of 30+ is recommended.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>

                    وأنا أفهم أن النتائج السريرية قد تختلف تبعا لعوامل فردية، بما في ذلك التاريخ الطبي،
                    والجلد ونوع الشعر، وامتثال المريض بتعليمات العلاج قبل / بعد
                    .
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_18" value="8">
                        <span class="custom-control-label">
                            I understand that this procedure may cause bruising, blistering, scarring, hypopigmentation (lightening of the skin), and hyperpigmentation (darkening of the skin).  I understand that sun exposure, tanning beds, and self tanners and not adhering to the post care instructions may increase my chances of complications.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>

                    أنا أفهم أن  منتجات التريتينون  يجب وقفها قبل 3 أيام على الأقل للعلاج .
                    الوشم والماكياج الدائم في المنطقة المعالجة يمكن أن  يتغير مع العلاج بالليزر. العدوى الفيروسية مثل الهربس البسيط (القروح الباردة) يمكن تفعيلها يجب اعلام الطبيب  بالتاريخ الطبي الكامل بما في ذلك الأدوية والحساسية ونوع  الجلد

                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_19" value="9">
                        <span class="custom-control-label">
                            I understand that Tretinoin products must be discontinued at least 3 days prior to treatment and Accutane must be discontinued for 6 months prior to treatment.  Tattoos and permanent makeup in the treatment area can be altered with laser treatments.  Viral infections such as herpes simplex (cold sores) can be activated.  A complete medical history is to be completed including medications, allergies and skin type.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>

                    ربما سوف تشمل الآثار احمرار مؤقت للجلد مماثل لحروق الشمس. قد يحدث بعض
                    التورم وربما تقشر خفيف ، تزول هذه  الآثار الجانبية في غضون بضع ساعات إلى عدة أيام بعد العلاج
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_20" value="10">
                        <span class="custom-control-label">
                            Skin effects will possibly include temporary redness similar to sunburn.  Some swelling and possibly light crusting may occur.  These side effects should resolve within a few hours to several days following treatment.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>

                    أقر بأنني قد قرأت ما سبق وتم الرد على جميع أسئلتي وقد عبرت عن  ارتياحي الكامل. أنا أفهم أن مقدم(ة) الرعاية الصحية لم  يقدم  لي أي ضمانات عن نتائج هذا الإجراء و أتقبل المخاطر و المضاعفات المحتملة. وأنا  أوافق على عدم  تحميل المركز أو الطبيب (ة)  ،الاخصائية  اية مسؤولية عن نتائج العلاج

                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_21" value="11">
                        <span class="custom-control-label">
                            I acknowledge that I have read the above & all my questions have been answered to my full satisfaction.  I understand that my healthcare provider has made no guarantees to me about the results of this procedure & accept the risks of possible complications & consequences.  I agree not to hold the hospital, my physicians / healthcare provider(s) responsible for the outcome of the treatments(s).
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>

                    تم شرح هذه النقاط  بالكامل و قرائتها و مناقشتها بشكل جيد و كامل قبل التوقيع على هذه الوثيقة .

                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_22" value="12">
                        <span class="custom-control-label">
                            I give my permission to allow Dr.
                            <label class="text-red">@emr.doc_name</label>
                            & such associate / assistants to perform this treatment.
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>

                    أمنح الإذن بالسماح للدكتور <label class="text-red">@emr.doc_name</label> ومثل هؤلاء المساعدين/المساعدين بإجراء هذا العلاج.
                </p>
            </div>
        </div>
        <div class="row text-justify">
            <div class="col-lg-6 mb-2">
                <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                    <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                        <input type="checkbox" class="custom-control-input" name="lrcc_1" id="lrcc_23" value="13">
                        <span class="custom-control-label">
                            I consent to allow this form to be valid for all subsequent laser treatments for a period of 1 year from the date on this consent.
                            .
                        </span>
                    </label>
                </div>
            </div>
            <div dir="rtl" class="col-lg-6  mb-2 text-right pl-3">
                <p>

                    أوافق على ان صلاحية هذه  الوثيقة سنة واحدة من التارح المذكور أدناه و هي سارية المفعول لعدة جلسات ليزر
                </p>
            </div>
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-sm-12 col-md-12 col-lg-12 text-center table-responsive">
            <table class="table table-bordered table-condensed">
                <tr>
                    <td colspan="3" class="font-weight-bold text-danger fs-18" width="100%">
                        Sign here, only if all of your questions have been answered to your satisfaction
                        <br />
                        قم بالتوقيع هنا، فقط إذا تمت الإجابة على جميع أسئلتك بما يرضيك
                    </td>
                </tr>
                <tr>
                    <td width="50%">
                        <div id="pat_sign_box" class="d-none">
                            <img alt="stamp" id="pat_sign" class="avatar avatar-xl bsquare" />
                        </div>
                    </td>
                    <td width="50%">
                        <img alt="stamp" src="@emr.doc_sign" id="doc_sign" class="avatar avatar-xl bsquare" />
                    </td>
                </tr>
                <tr>
                    <td width="50%">
                        <label class="form-label text-red text-left text-capitalize">@emr.pat_name&nbsp;</label>
                        <span class="font-weight-semibold">Patient Name</span>
                        <br />
                        <span class="font-weight-semibold">اسم المريض</span>
                        <br /><br />
                        <label class="form-label text-red text-left text-capitalize">@emr.app_fdate&nbsp;</label>
                        <span class="font-weight-semibold">Date</span>
                        <br />
                        <span class="font-weight-semibold">تاريخ</span>
                    </td>
                    <td width="50%">
                        <label class="form-label text-red text-left text-capitalize">@emr.doc_name&nbsp;</label>
                        <span class="font-weight-semibold">Doctor’s Name</span>
                        <br />
                        <span class="font-weight-semibold">اسم الطبيب</span>
                        <br /><br />
                        <label class="form-label text-red text-left text-capitalize">@emr.app_fdate&nbsp;</label>
                        <span class="font-weight-semibold">Date</span>
                        <br />
                        <span class="font-weight-semibold">تاريخ</span>
                    </td>
                </tr>
                <tr>
                    <td class="font-weight-semibold text-blue text-center" width="50%">
                        Patient  Signature
                        <br />
                        توقيع المريض
                        <br />
                        <div class="btn-group mr-2">
                            <div class="dropdown">
                                <button type="button" class="btn-sm btn-secondary me-2 mb-2 dropdown-toggle" data-bs-toggle="dropdown">
                                    <i class="fa fa-paint-brush">&nbsp;&nbsp;</i> Patient
                                </button>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" onclick="openSignaturePad('patient')">Tab</a>
                                    <a class="dropdown-item" onclick="openWacomTabSignaturePad('patient')">Wacom Tab</a>
                                </div>
                            </div>
                        </div>
                    </td>

                    <td class="font-weight-semibold text-blue text-center" width="50%">
                        Doctor’s Sign & Stamp
                        <br />علامة وختم الطبيب
                    </td>

                </tr>
            </table>
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-sm-12 col-md-12 col-lg-12 text-center">
            <div class="btn-list btn-animation">
                <button type="submit" class="btn btn-success btn-sm" id="btn_Insert">Save</button>
                <button type="button" class="btn btn-outline-dark btn-sm" id="btn_Reset">Reset</button>
                <button type="button" class="btn btn-danger btn-sm d-none" id="btn_Delete">Delete</button>
                <button type="button" class="btn btn-sm btn-outline-success d-none" id="btn_Print"> Download/Print </button>
            </div>
        </div>
    </div>
</form>
<script type="text/javascript">
    $(function () {
        if ("@emp_designation.ToString()" === "Super Administrator") {
            $("#btn_Insert").show();
        }
        else {
            if ("@emr.set_emr_lock" == "NoLock") {
                $("#btn_Insert").show();
            }
            else {
                if ("@emr.app_ae_date" >= "@emr.today") {
                    $("#btn_Insert").show();
                }
                else {
                    $("#btn_Insert").hide();
                }
            }
        }


    });


    //#region Add  Click
    $('#btn_Insert').on('click', function (e) {
        e.preventDefault();
        /*if ($("#form_Ematrix").valid()) {*/
            $('#btn_Insert').removeClass("btn btn-sm btn-success");
            $('#btn_Insert').addClass("btn btn-sm btn-success btn-loaders btn-icon");
            $('#btn_Insert').html("Saving the Record....");

            var checkbox_new = $.map($(':checkbox[name=lrcc_1]:checked'), function (n, i) {
                return n.value;
            }).join(',');

            console.log(checkbox_new);
            var _dateInsert = {
                "lrccId": 0,
               "lrcc_1": checkbox_new,
                "lrcc_appId": @emr.appId,
               //"icc_status": "Active",
                "__RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val()
            }

            console.log(_dateInsert);
            $.ajax({
                type: "Post",
                url: "@Url.Action("InsertLaserHair", "LaserHair", new {area = "ConsentForms" })",
                dataType: 'JSON',
                data: _dateInsert,
                success: function (data) {
                    $('#btn_Insert').removeClass("btn btn-sm btn-success btn-loaders btn-icon");
                    $('#btn_Insert').addClass("btn btn-sm btn-success");
                    $('#btn_Insert').html("Save Changes");

                    if (data.isSuccess) {
                        if (data.isInserted) {
                            var alertPlaceholder = document.getElementById("Alert");

                            function alert(e, t) {
                                var l = document.createElement("div");
                                l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" role="alert">' + e +
                                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
                            }
                            alert("<i class='fe fe-check-circle text-white'></i>Laser Hair Consent Form Saved Successfully!", "success");
                            Timeout();
                            $("#btn_Delete").removeClass("d-none");
                            $("#btn_Print").removeClass("d-none");
                        }
                        else {
                            let html = "<div class='col-12 col-sm-12 col-md-6 d-flex justify-content-center'>" +
                                "<div class='alert alert-warning' role='alert'>" +
                                "<button type='button' class='btn-close mr-negative-16' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                                "<strong>Warning.. Laser Hair Consent Form already Exists..</strong><br/>" +
                                "</div></div>";
                            $("#Alert").html(html);
                        }
                    }
                    else {
                        let html = "<div class='col-12 col-sm-12 col-md-6 d-flex justify-content-center'>" +
                        "<div class='alert alert-danger' role='alert'>" +
                        "<button type='button' class='btn-close mr-negative-16' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                        "<strong>Validation Error.. Please correct before you submit the form!&nbsp;</strong><br/><ul>";

                        $.each(data.message, function (index, value) {
                            html += "<li><small>" + value + "</small><li>";
                            var elem = $("#" + index);
                            if (elem.hasClass("select2-hidden-accessible")) {
                                $("#select2-" + elem.attr("id") + "-container").parent().addClass('error');
                            }
                            else {
                                $(elem).addClass(" is-invalid");
                            }

                            setTimeout(function () {
                                if (elem.hasClass("select2-hidden-accessible")) {
                                    $("#select2-" + elem.attr("id") + "-container").parent().removeClass('error');
                                }
                                else {
                                    $(elem).removeClass("is-invalid");
                                }
                                }, 5000);
                        });

                        html += "</ul></div></div>";

                        $("#error").html(html);
                    }
                },
                error: function (xhr) {
                    $('#btn_Insert').removeClass("btn btn-sm btn-success btn-loaders btn-icon");
                    $('#btn_Insert').addClass("btn btn-sm btn-warning");
                    $('#btn_Insert').html("Add");
                    Timeout();
                }
            });
       // }
        //else {
        //    $('.modal-body').animate({
        //        scrollTop: ($('.has-error').offset().top - 300)
        //    }, 2000);
        //}
    });
    //#endregion Add Click

    //#region Delete Click
    $('#btn_Delete').on('click', function (e) {
        e.preventDefault();
        $('#btn_Delete').removeClass("btn btn-success");
        $('#btn_Delete').addClass("btn btn-success btn-loaders btn-icon");
        $('#btn_Delete').html("Deleting the Record....");

        $.ajax({
            url: '@Url.Action("DeleteLaserHair", "LaserHair", new { area = "ConsentForms" })?appId=' + @emr.appId,
            type: "POST",
            dataType: 'JSON',
            success: function (data) {
                $('#btn_Delete').removeClass("btn btn-success btn-loaders btn-icon");
                $('#btn_Delete').addClass("btn btn-warning");
                $('#btn_Delete').html("Delete");
                if (data.isAuthorized) {
                    if (data.success) {
                        var alertPlaceholder = document.getElementById("Alert");
                        function alert(e, t) {
                            var l = document.createElement("div");
                            l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" >' + e +
                                '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
                        }
                        alert("<i class='fe fe-check-circle text-white'></i> Laser Hair Consent Form Deleted Successfully!", "success");
                        clearControls();
                        Timeout();

                        $('#btn_Delete').addClass("d-none");
                        $("#pat_sign_box").addClass("d-none");

                    }
                    else {
                        let html = "<div class='col-12 col-sm-12 col-md-12 d-flex justify-content-center'>" +
                            "<div class='alert alert-warning' role='alert'>" +
                            "<button type='button' class='btn-close mr-negative-16' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                            "<strong>Error!.. Failed to Delete..</strong><br/>" +
                            "</div></div>";
                        $("#error").html(html);
                    }
                }
                else {
                    var alertPlaceholder = document.getElementById("Alert");
                    function alert(e, t) {
                        var l = document.createElement("div");
                        l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" >' + e +
                            '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
                    }
                    alert("<i class='fe fe-check-circle text-white'></i> You do not have Enough Privileges to Delete this Designation!", "Access Denied!");
                }
            },
            error: function (xhr) {
                $('#btn_Delete').removeClass("btn btn-success btn-loaders btn-icon");
                $('#btn_Delete').addClass("btn btn-Delete");
                $('#btn_Delete').html("Delete");
                Timeout();
            }
        })
    });
//#endregion

//#region Print
$('#btn_Print').on('click', function (e) {
    e.preventDefault();
    $('#btn_Print').removeClass("btn btn-success");
    $('#btn_Print').addClass("btn btn-success btn-loaders btn-icon");
    $('#btn_Print').html("Printing the Record....");
    $.ajax({
        type: "Get",
        url: "@Url.Action("PrintPDFConsent", "LaserHair", new {area = "ConsentForms" })?appId=" + @emr.appId + "&form=LaserHair",
        dataType: 'JSON',
        success: function (data) {
            if (data.isAuthorized) {
                if (data.success) {
                    window.location.href = data.message.pdfPath
                }
            }
        },
        error: function (xhr) {
            console.log(xhr);
        }
    });
});
//#endregion Print

    //#region Reset
    $('#btn_Reset').on('click', function (e) {
        e.preventDefault();
        clearControls();
    });
    //#endregion Reset

    //#region Clear Controls
    var clearControls = function () {
        $(".form-control").val("");
        $("input[name='lrcc_1']:checkbox").prop('checked', false);
        $("#pat_sign").attr("src", "");
    }
    //#endregion Clear Controls

    //#region Wacom Tab Signature
        var openWacomTabSignaturePad = function (id) {
            var _data = {
                "patId": @emr.patId,
                "person": id,
                "form": "LaserHair",
                "appId": @emr.appId,
                "formname":"LaserHair",
                "formlink":"",
                "eSign":""
            }
            $.ajax({
                type: "GET",
                url: "@Url.Action("WacomTabSignaturePad", "WacomTabSignaturePad", new { area = "Common" })",
                contentType: "application/json",
                dataType: "html",
                data: _data,
                success: function (response) {
                    $("#signature_pad_body").html(response);
                    $("#signature_pad").modal("show");
                },
                error: function (xhr) {
                    console.log("Error :" + xhr.statusText);
                }
            });
        }
    //#endregion

    //#region Signature
    var openSignaturePad = function (id) {
        var _data = {
            "patId": @emr.patId,
            "person": id,
            "form": "LaserHair",
            "appId": @emr.appId,
            "formname":"LaserHair",
            "formlink":"",
            "eSign":""
        }
        $.ajax({
            type: "GET",
            url: "@Url.Action("SignaturePad", "SignaturePad", new { area = "Common" })",
            contentType: "application/json",
            dataType: "html",
            data: _data,
            success: function (response) {
                $("#signature_pad_body").html(response);
                $("#signature_pad").modal("show");
            },
            error: function (xhr) {
                console.log("Error :" + xhr.statusText);
            }
        });
    }
    //#endregion Signature

    $('#signature_pad').on('hidden.bs.modal', function () {
        if (localStorage.getItem("sign") != null) {
            GetSignaturename('patient');
            localStorage.removeItem("sign");
        }
    });

    //#region Get Signature
    var GetSignaturename = function  (person) {
        $.ajax({
            url: '@Url.Action("GetSignature", "SignaturePad", new { area = "Common" })?appId=' + @emr.appId + '&person=' + person + '&form=LaserHair',
            type: "GET",
            dataType: "json",
            async: false,
            success: function (response) {
                console.log(response);
                let sign = response[0].psb_sign;
                if (response[0].person == "patient") {
                    $("#pat_sign_box").removeClass("d-none");
                   $("#pat_sign").attr("src", sign);
                }

            },
            error: function (xhr) {
                console.log(xhr);
                alert(xhr);
            }

        });
    };
    //#endregion Get Signature

    //#region Alert Timeout
    function Timeout() {
        window.setTimeout(function () {
            $(".alert").fadeTo(500, 0).slideUp(500, function () {
                $(this).remove();
            });
        }, 4200);
    }
    //#endregion Alert Timeout

</script>