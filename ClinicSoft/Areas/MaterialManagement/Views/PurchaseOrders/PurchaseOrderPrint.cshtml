@model BusinessEntities.Accounts.MaterialManagement.PurchaseOrderAndItems

@{
    ViewBag.Title = "Print Purchase Order";
}
<title>ClinicSoft 9.0 - Powered By Vision Technologies | @ViewBag.Title</title>

<link rel="icon" href="~/assets/images/brand/favicon.ico" type="image/x-icon" />

<!--Bootstrap css -->
<link id="style" href="~/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
@*<link id="style" href="@Url.Content("~/assets/plugins/bootstrap/css/bootstrap.min.css")" rel="stylesheet">*@

<link id="style" href="~/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
@*<link id="style" href="@Url.Content("~/assets/plugins/bootstrap/css/bootstrap.min.css")" rel="stylesheet">*@
<!-- Style css -->
<link href="~/assets/css/style.css" rel="stylesheet" />
<link href="~/assets/css/dark.css" rel="stylesheet" />
<link href="~/assets/css/skin-modes.css" rel="stylesheet" />

<!-- Animate css -->
<link href="~/assets/css/animated.css" rel="stylesheet" />

<!-- P-scroll bar css-->
<link href="~/assets/plugins/p-scrollbar/p-scrollbar.css" rel="stylesheet" />

<!---Icons css-->
<link href="~/assets/css/icons.css" rel="stylesheet" />

<!-- Simplebar css -->
<link rel="stylesheet" href="~/assets/plugins/simplebar/css/simplebar.css">

<!-- INTERNAL Morris Charts css -->
<link href="~/assets/plugins/morris/morris.css" rel="stylesheet" />

<!-- INTERNAL Select2 css -->
<link href="~/assets/plugins/select2/select2.min.css" rel="stylesheet" />

<!---Icons css-->
<link href="~/assets/css/icons.css" rel="stylesheet" />

<!-- INTERNAL Fullcalendar css-->
<link href='~/assets/plugins/fullcalendar/fullcalendar.css' rel='stylesheet' />
<link href='~/assets/plugins/fullcalendar/fullcalendar.print.min.css' rel='stylesheet' media='print' />

<!--Date Picker-->
<link href="~/assets/plugins/bootstrap-datepicker/bootstrap-datepicker.css" rel="stylesheet" />

<!-- Data table css -->
@*<link href="~/assets/plugins/datatables/DataTables/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
    <link href="~/assets/plugins/datatables/Responsive/css/responsive.bootstrap4.min.css" rel="stylesheet" />*@
<link href="~/assets/plugins/datatables/DataTables/css/dataTables.bootstrap5.css" rel="stylesheet" />
<link href="~/assets/plugins/datatables/Buttons/css/buttons.bootstrap5.min.css" rel="stylesheet">
<link href="~/assets/plugins/datatables/Responsive/css/responsive.bootstrap5.min.css" rel="stylesheet" />
<link href="~/assets/plugins/datatables/Select/css/select.dataTables.min.css" rel="stylesheet" />
<link href="~/assets/plugins/datatables/Checkbox/dataTables.checkboxes.css" rel="stylesheet" />

<!-- Color Skin css -->
<link id="theme" href="~/assets/colors/color1.css" rel="stylesheet" type="text/css" />

<!--- INTERNAL Sweetalert css-->
<link href="~/assets/plugins/sweet-alert/jquery.sweet-modal.min.css" rel="stylesheet" />
<link href="~/assets/plugins/sweet-alert/sweetalert.css" rel="stylesheet" />
<link href="~/assets/plugins/sweetalert2/sweetalert2.min.css" rel="stylesheet" />
<!-- INTERNAL Accordion Css -->
<link href="~/assets/plugins/accordion/accordion.css" rel="stylesheet" />
<!-- INTERNAL Mutipleselect css-->
<!--<link rel="stylesheet" href="~/assets/plugins/multipleselect/multiple-select.css">-->
<!-- INTERNAL multi css-->
<!--<link rel="stylesheet" href="~/assets/plugins/multi/multi.min.css">-->
<!-- INTERNAL Sumoselect css-->
<link rel="stylesheet" href="~/assets/plugins/sumoselect/sumoselect.css">
<link href="~/assets/plugins/charts-c3/c3-chart.css" rel="stylesheet" />
<link href="~/assets/plugins/notify/css/jquery.growl.css" rel="stylesheet" />
<link href="~/assets/plugins/notify/css/notifIt.css" rel="stylesheet" />
<link href="~/assets/plugins/prism/prism.css" rel="stylesheet" />
<link href="~/assets/css/custom.css" rel="stylesheet" />
<!-- INTERNAL  Tabs css-->
<link href="~/assets/plugins/tabs/style.css" rel="stylesheet" />
<!-- Jquery js-->
<script src="~/assets/js/jquery.min.js"></script>


<!-- INTERNAl Quill css -->
<link href="~/assets/plugins/quill/quill.snow.css" rel="stylesheet">
<link href="~/assets/plugins/quill/quill.bubble.css" rel="stylesheet">


<!-- Row-->
<div class="row" id="printDiv">
    <div class="col-md-12">
        <div class="card overflow-hidden">
            <div class="card-body">
                <div class="text-center">
                    <img src="@Model.purchaseOrders.set_header_image" />
                </div>

                <h2 class="font-weight-bold text-primary">@Model.purchaseOrders.pur_type</h2>
                <div class="row fw-bold">
                    <div class="col-sm-12 col-md-5 col-lg-5">
                        <div class="expanel expanel-default">
                            <div class="expanel-heading">
                                <h3 class="expanel-title">Vendor Detail</h3>
                            </div>
                            <div class="expanel-body">
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Name</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-4 col-lg-4">
                                        @Model.purchaseOrders.sup_name
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Mobile</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.sup_mob
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Email</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.sup_email
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>TRN</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.sup_vat_regno
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Address</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.sup_address
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-7 col-lg-7">
                        <div class="expanel expanel-default">
                            <div class="expanel-heading">
                                <h3 class="expanel-title">Purchase Detail</h3>
                            </div>
                            <div class="expanel-body">
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Branch</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-7 col-lg-7">
                                        @Model.purchaseOrders.branch_name
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>P.O.No#</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-3 col-lg-3">
                                        @Model.purchaseOrders.pur_ocode
                                    </div>
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Date</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-3 col-lg-3">
                                        @Model.purchaseOrders.pur_odate
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Enquiry No#</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-3 col-lg-3">
                                        @Model.purchaseOrders.pur_enqno
                                    </div>
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Date</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-3 col-lg-3">
                                        @Model.purchaseOrders.pur_odate
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Quotation No#</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-3 col-lg-3">
                                        @Model.purchaseOrders.pur_quono
                                    </div>
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Date</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-3 col-lg-3">
                                        @Model.purchaseOrders.pur_qdate
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Payment Terms</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-3 col-lg-3">
                                        @Model.purchaseOrders.pur_pay_terms - Days
                                    </div>
                                    <div class="col-sm-6 col-md-2 col-lg-2">
                                        <strong>Validity</strong>
                                    </div>
                                    <div class="col-sm-6 col-md-1 col-lg-1">
                                        <strong>:</strong>
                                    </div>
                                    <div class="col-sm-12 col-md-3 col-lg-3">
                                        @Model.purchaseOrders.pur_validity - Days
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dropdown-divider"></div>
                <div class="row fw-bold">
                    <div class="col-sm-12 col-md-4 col-lg-4">
                        <div class="expanel expanel-default">
                            <div class="expanel-heading">
                                <h3 class="expanel-title">Ship To</h3>
                            </div>
                            <div class="expanel-body">
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_ship_1
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_ship_2
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_ship_3
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_ship_4
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-4 col-lg-4">
                        <div class="expanel expanel-default">
                            <div class="expanel-heading">
                                <h3 class="expanel-title">Bill To</h3>
                            </div>
                            <div class="expanel-body">
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_bill_1
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_bill_2
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_bill_3
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_bill_4
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-4 col-lg-4">
                        <div class="expanel expanel-default">
                            <div class="expanel-heading">
                                <h3 class="expanel-title">Contact info. of Buyer</h3>
                            </div>
                            <div class="expanel-body">
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_buy_1
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_buy_2
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_buy_3
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        @Model.purchaseOrders.pur_buy_4
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dropdown-divider"></div>
                <div class="table-responsive push">
                    <table class="table table-bordered table-hover text-nowrap">
                        <tr class=" ">
                            <th class="text-center " style="width: 1%"></th>
                            <th class="text-wrap">Item Code / Name</th>
                            <th class="text-wrap">Description</th>
                            @{ if (Model.purchaseOrders.pur_type == "Purchase Invoice")
                                {
                                    <th class="text-wrap">Batch No.</th>
                                    <th class="text-wrap">Expiry Date</th>
                                }
                            }

                            <th class="text-center" style="width: 1%">Qty-UoM</th>
                            <th class="text-end" style="width: 1%">Free Qty-UoM</th>
                            <th class="text-end" style="width: 1%">Unit Price</th>
                            <th class="text-end" style="width: 1%">Total</th>
                            <th class="text-end" style="width: 1%">Disc.-Type</th>
                            <th class="text-end" style="width: 1%">Disc.Values</th>
                            <th class="text-end" style="width: 1%">NET</th>
                            <th class="text-end" style="width: 1%">VAT</th>
                            <th class="text-end" style="width: 1%">Net+VAT</th>
                        </tr>
                        @{int count = 0; }
                        @foreach (BusinessEntities.Accounts.MaterialManagement.PurchaseOrderItems i in Model.purchaseItems)
                        {
                            count++;

                            <tr>
                                <td class="text-center">@count.ToString("D2")</td>
                                <td>
                                    <p class="font-weight-semibold mb-1">@i.item_code</p>
                                    <div class="text-wrap">@i.item_name</div>
                                </td>
                                <td>@i.pi_desc</td>
                                @{ if (Model.purchaseOrders.pur_type == "Purchase Invoice")
                                    {
                                        <td>@i.pi_batch</td>
                                        <td>@i.pi_edate</td>
                                    }
                                }
                                <td class="text-center">@i.pi_oqty - @i.pi_uom</td>
                                <td class="text-center">@i.pi_freeQty - @i.pi_freeUOM</td>
                                <td class="text-end">@i.pi_uprice</td>
                                <td class="text-end">@i.pi_total.ToString("N2")</td>
                                <td class="text-center"> @i.pi_disc - @i.pi_disc_type </td>
                                <td class="text-end">@i.pi_disc_value.ToString("N2")</td>
                                <td class="text-end">@i.pi_net.ToString("N2")</td>
                                <td class="text-end">@i.pi_vat.ToString("N2")</td>
                                <td class="text-end">@i.pi_netvat.ToString("N2")</td>
                            </tr>

                        }
                        <tr>
                            @{ if (Model.purchaseOrders.pur_type == "Purchase Invoice")
                                {
                                    <td colspan="12" class="font-weight-semibold">Amount In Words : @Model.purchaseOrders.amount_in_words /-</td>
                                }
                                else
                                {
                                    <td colspan="10" class="font-weight-semibold">Amount In Words : @Model.purchaseOrders.amount_in_words /-</td>
                                }
                            }
                            <td class="font-weight-semibold text-end">Total (in AED)</td>
                            <td class="text-end">@Model.purchaseOrders.pur_total.ToString("N2")</td>
                        </tr>
                        <tr>
                            @{ if (Model.purchaseOrders.pur_type == "Purchase Invoice")
                                {
                                    <td rowspan="4" colspan="12" class="font-weight-semibold">@Model.purchaseOrders.pur_notes</td>
                                }
                                else
                                {
                                    <td rowspan="4" colspan="10" class="font-weight-semibold">@Model.purchaseOrders.pur_notes</td>
                                }
                            }


                            <td class="font-weight-semibold text-end">Discount (in AED)</td>
                            <td class="text-end">@Model.purchaseOrders.pur_disc_val.ToString("N2")</td>
                        </tr>
                        <tr>
                            <td class="font-weight-semibold text-end">Net Amount (in AED)</td>
                            <td class="text-end">@Model.purchaseOrders.pur_net.ToString("N2")</td>
                        </tr>
                        <tr>
                            <td class="font-weight-semibold text-end">VAT (in AED)</td>
                            <td class="text-end">@Model.purchaseOrders.pur_vat.ToString("N2")</td>
                        </tr>
                        <tr>
                            <td class="font-weight-semibold text-end">Net + VAT </td>
                            <td class="text-end">@Model.purchaseOrders.pur_netvat.ToString("N2")</td>
                        </tr>
                    </table>
                </div>


                <div class="row">
                    <div class="col-sm-6 col-md-6 col-lg-6 ">
                        <label class="fs-15 fw-bold">Prepared by</label><br />
                        <label class="fw-bold">@Model.purchaseOrders.madeby_name</label>

                    </div>
                    <div class="col-sm-6 col-md-6 col-lg-6">
                        <label class="pull-right fs-15 fw-bold">Approved by</label>
                    </div>

                </div>

                <div class="text-center">
                    <img src="@Model.purchaseOrders.set_footer_image" />
                </div>

            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    //#region Page Load & Initialization
    $(function () {
        var elem = 'printDiv';
        var header_str = '<html><head><title>' + document.title + '</title></head><body>';
        var footer_str = '</body></html>';
        var new_str = document.getElementById(elem).innerHTML;
        var old_str = document.body.innerHTML;
        document.body.innerHTML = header_str + new_str + footer_str;
        window.print();
        document.body.innerHTML = old_str;
        return false;
    });
    //#endregion Page Load & Initialization
</script>



