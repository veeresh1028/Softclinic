@model BusinessEntities.EMRForms.Amity
@using System.Linq;
@using System.Security.Claims;
@using BusinessEntities;
@{
    var claims = ClaimsPrincipal.Current.Identities.First().Claims.ToList();
    var emp_designation = claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value).SingleOrDefault();
    EMRInfo emr = (EMRInfo)TempData["emr_data"];
    TempData.Keep("emr_data");
}

<form id="form_AmityDecision" class="fs-14" autocomplete="off" name="Amity" ondrop="return false;" onpaste="return false;" oncut="return false;">
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.car_Id, new { @id = "car_Id", @value = "@Model.car_Id" })

    <div class="row ">
        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-12">
                <label class="form-label mb-2 text-danger">
                    SECTION A: MEDICAL PROVIDER DETAILS
                </label>
            </div>
            <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
                <div class="col-sm-11 col-md-6 col-lg-2 ps-0">
                    <label class="form-label">
                        Provider Name&nbsp;
                    </label>
                </div>
                <div class="d-flex justify-content-center w-8  form-label">
                    :
                </div>
                <div class="col-sm-12 col-md-6 col-lg-3 mb-2">
                    @if (@emr.ic_name != "")
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">@emr.ic_name&nbsp;</span>
                    }
                    else
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                    }
                </div>
            </div>
            <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
                <div class="col-sm-11 col-md-6 col-lg-2 ps-0">
                    <label class="form-label">
                        Provider License No&nbsp;
                    </label>
                </div>
                <div class="d-flex justify-content-center w-8  form-label">
                    :
                </div>
                <div class="col-sm-12 col-md-6 col-lg-3 mb-2">
                    @if (@emr.set_permit_no != "")
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">@emr.set_permit_no&nbsp;</span>
                    }
                    else
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                    }
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-12">
                <label class="form-label mb-2 text-danger">
                    SECTION B: PATIENT DETAILS
                </label>
            </div>
            <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
                <div class="col-sm-11 col-md-6 col-lg-2 ps-0">
                    <label class="form-label mb-2">
                        Patient Name&nbsp;
                    </label>
                </div>
                <div class="d-flex align-items-center justify-content-center w-8  form-label">
                    :
                </div>
                <div class="col-sm-12 col-md-6 col-lg-3 mb-2">
                    @if (@emr.pat_name != "")
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">@emr.pat_name&nbsp;</span>
                    }
                    else
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                    }
                </div>
            </div>
            <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
                <div class="col-sm-11 col-md-6 col-lg-2 ps-0">
                    <label class="form-label mb-2">
                        Patient Mobile No&nbsp;
                    </label>
                </div>
                <div class="d-flex align-items-center justify-content-center w-8  form-label">
                    :
                </div>
                <div class="col-sm-12 col-md-6 col-lg-3 mb-2">
                    @if (@emr.pat_mob != "")
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">@emr.pat_mob&nbsp;</span>
                    }
                    else
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                    }
                </div>
            </div>
        </div>
        <div class="row">
            <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
                <div class="col-sm-11 col-md-6 col-lg-2 ps-0">
                    <label class="form-label mb-2">
                        Card Number&nbsp;
                    </label>
                </div>
                <div class="d-flex align-items-center justify-content-center w-8  form-label">
                    :
                </div>
                <div class="col-sm-12 col-md-6 col-lg-3 mb-2">
                    @if (@emr.pi_insno != "")
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">@emr.pi_insno&nbsp;</span>
                    }
                    else
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                    }
                </div>
            </div>
            <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
                <div class="col-sm-11 col-md-6 col-lg-2 ps-0">
                    <label class="form-label mb-2">
                        Patient File No&nbsp;
                    </label>
                </div>
                <div class="d-flex align-items-center justify-content-center w-8  form-label">
                    :
                </div>
                <div class="col-sm-12 col-md-6 col-lg-3 mb-2">
                    @if (@emr.pat_code != "")
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">@emr.pat_code&nbsp;</span>
                    }
                    else
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                    }
                </div>
            </div>
        </div>
        <div class="row">
            <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
                <div class="col-sm-11 col-md-6 col-lg-2 ps-0">
                    <label class="form-label mb-2">
                        Patient DOB&nbsp;
                    </label>
                </div>
                <div class="d-flex align-items-center justify-content-center w-8  form-label">
                    :
                </div>
                <div class="col-sm-12 col-md-6 col-lg-3 mb-2">
                    @if (@emr.pat_dob != "")
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">@emr.pat_dob&nbsp;</span>
                    }
                    else
                    {
                        <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                    }
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-12">
                <label class="form-label mb-2 text-danger">
                    SECTION C : CLAIM DETAILS
                </label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-6">
                <label class="text-black mb-2">
                    To be completed by Attending Physician (please tick √)&nbsp;
                </label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-6">
                <label class="text-black mb-2">
                    Emergency case?(please tick √)&nbsp;
                </label>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-6 col-lg-6">
                <div class="row">
                    <div class="col-sm-12 col-md-6 col-lg-4">
                        <label class="custom-control custom-radio">
                            <input type="radio" class="custom-control-input" name="car_checkbox[1]" value="1">
                            <span class="custom-control-label">InPatient</span>
                        </label>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-4">
                        <label class="custom-control custom-radio">
                            <input type="radio" class="custom-control-input" name="car_checkbox[1]" value="2">
                            <span class="custom-control-label">OutPatient</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-6">
                <div class="row">
                    <div class="col-sm-12 col-md-6 col-lg-2">
                        <label class="custom-control custom-radio">
                            <input type="radio" class="custom-control-input" name="car_checkbox[3]" value="3">
                            <span class="custom-control-label">Yes</span>
                        </label>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-2">
                        <label class="custom-control custom-radio">
                            <input type="radio" class="custom-control-input" name="car_checkbox[4]" value="4">
                            <span class="custom-control-label">No</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-6 col-lg-6">
                <label class="text-black mb-2">
                    Chief Complaint and symptoms&nbsp;
                </label>
                <label class="form-label text-red text-left" id="car_e1" name="">&nbsp;</label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-6">
                <label class="text-black mb-2">
                    What date did the patient first feel same/similar symptoms&nbsp;
                </label>
                <div class="input-group col-sm-12 col-md-12 col-lg-4">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <i class="fe fe-calendar"></i>
                        </div>
                    </div>
                    @Html.TextBoxFor(m => m.car_d1, new { @class = "form-control", @placeholder = "DD-MMMM-YYYY", @id = "car_d1" })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-6">
                <label class="text-black">
                    Significant signs&nbsp;
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6 mt-2">
                <label class="text-black mb-2">
                    Pre Authorisation No: (If Applicable)&nbsp;
                </label>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-6">
                <div class="row">
                    <div class="d-flex col-sm-12 col-md-12 col-lg-12 ps-0">
                        <div class="col-sm-11 col-md-6 col-lg-2">
                            <label class="text-black">
                                BP&nbsp;
                            </label>
                        </div>
                        <div class="d-flex align-items-center justify-content-center w-8  form-label">
                            :
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-3">
                            <label class="form-label text-red text-left" id="sign_bp" name="">&nbsp;</label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="d-flex col-sm-12 col-md-12 col-lg-12 ps-0">
                        <div class="col-sm-11 col-md-6 col-lg-2">
                            <label class="text-black">
                                Temp&nbsp;
                            </label>
                        </div>
                        <div class="d-flex align-items-center justify-content-center w-8  form-label">
                            :
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-3">
                            <label class="form-label text-red text-left" id="sign_temp" name="">&nbsp;</label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="d-flex col-sm-12 col-md-12 col-lg-12 ps-0">
                        <div class="col-sm-11 col-md-6 col-lg-2">
                            <label class="text-black">
                                Pulse&nbsp;
                            </label>
                        </div>
                        <div class="d-flex align-items-center justify-content-center w-8  form-label">
                            :
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-3">
                            <label class="form-label text-red text-left" id="sign_pulse" name="">&nbsp;</label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="d-flex col-sm-12 col-md-12 col-lg-12 ps-0">
                        <div class="col-sm-11 col-md-6 col-lg-2">
                            <label class="text-black">
                                Notes&nbsp;
                            </label>
                        </div>
                        <div class="d-flex align-items-center justify-content-center w-8  form-label">
                            :
                        </div>
                        <div class="col-sm-12 col-md-6 col-lg-3">
                            <label class="form-label text-red text-left" id="sign_notes" name="">&nbsp;</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3 mt-4">
                @Html.TextBoxFor(m => m.car_e4, new { @class = "form-control", @placeholder = "Enter #", @id = "car_e4", @width = "20px" })
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-6">
                <label class="text-black">
                    Other conditions&nbsp;
                </label>
                @Html.TextBoxFor(m => m.car_e3, new { @class = "form-control", @id = "car_e3", @width = "20px" })
            </div>
            <div class="col-sm-12 col-md-6 col-lg-6 mt-2">
                <label class="text-black mb-2">
                    Date of this Visit&nbsp;
                </label>
                <div class="input-group col-sm-12 col-md-12 col-lg-4">
                    <div class="input-group-prepend">
                        <div class="input-group-text">
                            <i class="fe fe-calendar"></i>
                        </div>
                    </div>
                    @Html.TextBoxFor(m => m.car_d2, new { @class = "form-control", @placeholder = "DD-MMMM-YYYY", @id = "car_d2" })
                </div>
            </div>
        </div>
        <div class="row">
            <label class="text-black">
                Diagnosis&nbsp;
            </label>
            <label class="form-label text-red text-left" id="car_e5" name="">&nbsp;</label>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="form-label">
                    Mandatory&nbsp;
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-3">
                <label class="text-black">
                    ICD code(please tick √)&nbsp;
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[5]" value="5">
                    <span class="custom-control-label">ICD9  </span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[5]" value="6">
                    <span class="custom-control-label">ICD10  </span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="text-black">
                    (See Amity Reference guide)&nbsp;
                </label>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="text-black">
                    Principal code&nbsp;
                </label>
                @Html.TextBoxFor(m => m.car_e6, new { @class = "form-control", @id = "car_e6", @width = "20px" })
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="text-black">
                    2nd code&nbsp;
                </label>
                @Html.TextBoxFor(m => m.car_e7, new { @class = "form-control", @id = "car_e7", @width = "20px" })
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="text-black">
                    3rd code&nbsp;
                </label>
                @Html.TextBoxFor(m => m.car_e8, new { @class = "form-control", @id = "car_e8", @width = "20px" })
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="text-black">
                    4th code&nbsp;
                </label>
                @Html.TextBoxFor(m => m.car_e9, new { @class = "form-control", @id = "car_e9", @width = "20px" })
            </div>
        </div>
        <div class="row">
            <label class="text-black">
                Please tick ( √) where appropriate&nbsp;
            </label>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[7]" value="7">
                    <span class="custom-control-label">Congenital</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[7]" value="8">
                    <span class="custom-control-label">Chronic</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[7]" value="9">
                    <span class="custom-control-label">RTA</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[7]" value="10">
                    <span class="custom-control-label">Psychiatric</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[7]" value="11">
                    <span class="custom-control-label">Others</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="text-black">
                    (please specify)&nbsp;
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                @Html.TextBoxFor(m => m.car_e10, new { @class = "form-control", @id = "car_e10", @width = "20px" })
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[12]" value="12">
                    <span class="custom-control-label">Check-up</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[12]" value="13">
                    <span class="custom-control-label">Acute</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[12]" value="14">
                    <span class="custom-control-label">Infertility</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[12]" value="15">
                    <span class="custom-control-label">Work Related</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-1">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[12]" value="16">
                    <span class="custom-control-label">Vaccination</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                <label class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" name="car_checkbox[12]" value="17">
                    <span class="custom-control-label">Pregnancy/Indicate LMP</span>
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-2">
                @Html.TextBoxFor(m => m.car_e11, new { @class = "form-control", @id = "car_e11", @width = "20px" })
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-12">
                <label class="form-label mb-2 text-danger">
                    SECTION D: PROPOSED MEDICAL MANAGEMENT PLAN
                </label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-12">
                <label class="text-black mb-2">
                    Suggestive line(s) of management: kindly, enumerate the recommended investigations and / or procedures&nbsp;
                </label>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12 col-md-12 col-lg-12">
                <div class="table-responsive">
                    <table id="tbl_Treatment" class="table table-striped table-bordered text-nowrap" style="width: 100%; cursor: pointer;">
                        <thead>
                            <tr style="color: #fff !important; background-color: #808080; border-color: #3C457D; ">
                                <th class="border-bottom-0 font-weight-semibold text-white">#</th>
                                <th class="border-bottom-0 font-weight-semibold text-white">CPT Code</th>
                                <th class="border-bottom-0 font-weight-semibold text-white">Treatment</th>
                                <th class="border-bottom-0 font-weight-semibold text-white">Quantity</th>
                                <th class="border-bottom-0 font-weight-semibold text-white">Type</th>
                                <th class="border-bottom-0 font-weight-semibold text-white">Cost</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-8">
            </div>
            <div class="col-sm-11 col-md-6 col-lg-2">
                <label class="text-black mb-2">
                    Total cost:&nbsp;
                </label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-1">
                <label class="text-black mb-2">
                    @Html.TextBoxFor(m => m.car_e12, new { @class = "form-control", @id = "car_e12", @width = "20px" })
                </label>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-6 col-lg-12">
                <label class="text-black mb-2">
                    Anticipated management plan&nbsp;
                </label>
                @Html.TextAreaFor(m => m.car_e13, new { @class = "form-control", @placeholder = "Please specify", @row = "2", @id = "car_e13" })
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-6 col-lg-4">
                <label class="text-black mb-2">
                    Referral Doctors Name: (If Patient has been Referred) :&nbsp;
                </label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-3">
                <span class="text-capitalize text-left text-red">@emr.doc_name&nbsp;</span>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-2">
                <label class="text-black mb-2">
                    Licence No:&nbsp;
                </label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-3">
                <span class="text-capitalize text-left text-red">@emr.emp_license&nbsp;</span>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-12">
                <label class="form-label mb-2 text-danger">
                    Patient declaration
                </label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-12">
                <p class="text-black mb-2 text-justify">
                    I declare that I am the patient, patient's parent or guardian (if patient's under 16 years of age) and that all information provided in the claim
                    form is to the best of my knowledge true and correct. This declaration gives Amity the permission to get all information about my claim including,
                    but not limited to, my current medical and previous medical providers/physician, pharmacy or any other person who has provided medical services to
                    me or my dependants. I agree that a copy of this consent shall have the validity of the original.
                </p>
            </div>
        </div>
        <div class="row ">
            <div class="col-sm-12 col-md-6 col-lg-6">

                <div class="form-group mb-3" style="display:none" id="patimg"><img alt="Signature" src="" id="pat_sign" class="avatar avatar-xl bsquare" /></div>
                <label class="form-label mb-2">
                    signature
                </label>
            </div>
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label text-red text-left" id="psb_date_witness" name="">&nbsp;</label>
                <label class="form-label mb-2">
                    Date
                </label>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-12">
                <label class="form-label mb-2 text-danger">
                    Medical practitioner declaration
                </label>
            </div>
            <div class="col-sm-11 col-md-6 col-lg-12">
                <p class="text-black mb-2 text-justify">
                    I declare that all information mentioned is correct and that the medical services shown on this form were medically indicated
                    and necessary for the management of this case.
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-4">
                <span class="text-capitalize text-left text-red">@emr.doc_name&nbsp;</span>
                <label class="form-label mb-2">
                    Name
                </label>
            </div>
            <div class="col-sm-11 col-md-12 col-lg-4">
                <span class="text-capitalize text-left text-red">@emr.emp_fax&nbsp;</span>
                <label class="form-label mb-2">
                    Tel/Fax
                </label>
            </div>
            <div class="col-sm-11 col-md-12 col-lg-4">
                <span class="text-capitalize text-left text-red">@emr.emp_license&nbsp;</span>
                <label class="form-label mb-2">
                    Licence No
                </label>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-11 col-md-12 col-lg-4">
                <img alt="stamp" src="@emr.doc_sign" id="doc_sign" class="avatar avatar-xl bsquare" />
                <label class="form-label mb-2">
                    Signature/Stamp
                </label>
            </div>
            <div class="col-sm-11 col-md-12 col-lg-4">
                <span class="text-capitalize text-left text-red">@emr.app_fdate&nbsp;</span>
                <label class="form-label mb-2">
                    Date
                </label>
            </div>
        </div>

        <div class="row ">
            <div class="row mt-2">
                <div class="col-sm-12 col-md-12 col-lg-12 text-center">
                    <div class="btn-list btn-animation">
                        <button type="submit" class="btn btn-success" id="btn_Insert_Amity">Add</button>
                        <button type="button" class="btn btn-outline-dark" id="btn_Reset_Amity">Reset</button>
                        <div class="btn-group mr-2">
                            <div class="dropdown">
                                <button type="button" class="btn-sm btn-secondary me-2 mb-2 dropdown-toggle" data-bs-toggle="dropdown">
                                    <i class="fa fa-paint-brush">&nbsp;&nbsp;</i> Patient
                                </button>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" onclick="openSignaturePad('patient')">Tab</a>
                                    <a class="dropdown-item" onclick="openWacomTabSignaturePad('patient')">Wacom Tab</a>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-outline-danger me-1" id="btn_Close_Amity" style="display:none">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
@*@section myScripts{*@
<script type="text/javascript">
    //#region Page Load
        var formName1 = $(form_AmityDecision).closest('form').attr('name');
        $(function () {
        validate();
        Get_Patient_Complaints();
        Get_Patient_signs();
        Get_Patient_Diagnosis();
        set_date();
        Get_AllPatientTreatments();
        });
    //#endregion Page Load

    //#region Validation Initialization
        var validate = function () {

            $("#form_EditAmity").validate({
                rules: {
                    car_e1: {
                        required: true
                    },

                },
                messages: {
                    car_e1: {
                        required: "Chief Complaint Required!"
                    },

                },
                highlight: function (element) {
                    var elem = $(element);
                    $(element).parent().addClass('has-error');
                    error_timeout(elem.attr("id"));
                },
                unhighlight: function (element) {
                    var elem = $(element);
                    $(element).parent().removeClass('has-error');
                },
                errorElement: 'span',
                errorClass: 'text-danger fw-bold',
                errorPlacement: function (error, element) {
                    var elem = $(element);
                    if (element.parent('.input-group').length) {
                        error.insertAfter(element.parent());
                    } else {
                        error.insertAfter(element);
                    }
                }
            });

        }
    //#endregion Validation Initialization

    //#region Load set Date
        var set_date = function () {
            $('#car_d1,#car_d2').bootstrapdatepicker({
                    format: "dd-MM-yyyy",
                    viewMode: "date",
                    todayHighlight: true,
                    autoclose: true,
                    multidate: false,
                    multidateSeparator: "-"
            });
            $("#car_d1,#car_d2").bootstrapdatepicker("setDate", '');
        }
    //#endregion

    //#region Load Get_Patient_Complaints
        var Get_Patient_Complaints = function () {
            $.ajax({
                type: "GET",
                url: "@Url.Action("Get_Patient_Complaints", "ReimbursementForms", new { area = "EMRForms" })?appId=" + "@emr.appId" + "&patId=" + @emr.patId,
                success: function (response) {
                    if (response.length > 0) {
                        var str2 = response[0].complaints;
                        var regex = /(|<([^>]+)>)/ig;
                        $("#car_e1").text(str2.replace(/(<p>|<\/p>)/g, ""));
                    }
                },
                error: function (xhr) {
                    console.log(xhr);
                }
            });
        }
    //#endregion

    //#region Load Get_Patient_signs
    var Get_Patient_signs = function () {
        $.ajax({
            type: "GET",
            url: "@Url.Action("Get_Patient_Signs", "ReimbursementForms", new { area = "EMRForms" })?appId="+@emr.appId,
            success: function (response) {
                if (response.length > 0) {
                    var str1 = response[0].sign_bp;
                    var str2 = response[0].sign_pulse;
                    var str3 = response[0].sign_temp;
                    var str4 = response[0].sign_notes;
                    var regex = /(|<([^>]+)>)/ig;
                    $("#sign_bp").text(str1.replace(/(<p>|<\/p>)/g, ""));
                    $("#sign_pulse").text(str2.replace(/(<p>|<\/p>)/g, ""));
                    $("#sign_temp").text(str3.replace(/(<p>|<\/p>)/g, ""));
                    $("#sign_notes").text(str4.replace(/(<p>|<\/p>)/g, ""));
                }
            },
            error: function (xhr) {
                console.log(xhr);
            }
        });
    }
//#endregion

    //#region Load Get_Patient_Diagnosis
        var Get_Patient_Diagnosis = function () {
            $.ajax({
                type: "GET",
                url: "@Url.Action("Get_Patient_Diagnosis", "ReimbursementForms", new { area = "EMRForms" })?appId=" + "@emr.appId" + "&patId=" + @emr.patId,
                success: function (response) {
                    if (response.length > 0) {
                        var str2 = response[0].diag_names;
                        var regex = /(|<([^>]+)>)/ig;
                        $("#car_e5").text(str2.replace(/(<p>|<\/p>)/g, ""));
                    }
                },
                error: function (xhr) {
                    console.log(xhr);
                }
            });
        }
    //#endregion

    //#region Wacom Tab Signature
        var openWacomTabSignaturePad = function (id) {
             var _data = {
                 "patId": @emr.patId,
                 "person": id,
                 "form": formName1,
                 "appId": @emr.appId,
                 "formname":"Amity",
                 "formlink":"PrintAmityClaim.aspx",
                 "eSign":""
             }
            $.ajax({
                type: "GET",
                url: "@Url.Action("WacomTabSignaturePad", "WacomTabSignaturePad", new { area = "Common" })",
                contentType: "application/json",
                dataType: "html",
                data: _data,
                success: function (response) {
                    $("#signature_pad_body").html(response);
                    $("#signature_pad").modal("show");
                },
                error: function (xhr) {
                    console.log("Error :" + xhr.statusText);
                }
            });
        }
    //#endregion

    //#region Signature
        var openSignaturePad = function (id) {
            var _data = {
                "patId": @emr.patId,
                "person": id,
                "form": formName1,
                "appId": @emr.appId,
                "formname":"Amity",
                "formlink":"PrintAmityClaim.aspx",
                "eSign":""
            }
            $.ajax({
                type: "GET",
                url: "@Url.Action("SignaturePad", "SignaturePad", new { area = "Common" })",
                contentType: "application/json",
                dataType: "html",
                data: _data,
                success: function (response) {
                    $("#signature_pad_body").html(response);
                    $("#signature_pad").modal("show");
                },
                error: function (xhr) {
                    console.log("Error :" + xhr.statusText);
                }
            });
        }
    //#endregion

    //#region Alert Timeout
        function Timeout() {
            window.setTimeout(function () {
                $(".alert").fadeTo(500, 0).slideUp(500, function () {
                    $(this).remove();
                });
            }, 4200);
        }
    //#endregion

    //#region Reset
        $('#btn_Reset_Amity').on('click', function (e) {
            e.preventDefault();
            clearControls();
        });
    //#endregion

    //#region Clear Controls
        var clearControls = function () {
            $("#car_e1").val("");
            $("#car_e2").val("");
            $("#car_e3").val("");
            $("#car_e4").val("");
            $("#car_e5").val("");
            $("#car_e6").val("");
            $("#car_e7").val("");
            $("#car_e8").val("");
            $("#car_e9").val("");
            $("#car_e10").val("");
            $("#car_e11").val("");
            $("#car_e12").val("");
            $("#car_e13").val("");
        }
    //#endregion

    //#region Insert Button Click
        $('#btn_Insert_Amity').on('click', function (e) {
            e.preventDefault();
            if ($("#form_AmityDecision").valid()) {
                $('#btn_Insert_Amity').removeClass("btn btn-success");
                $('#btn_Insert_Amity').addClass("btn btn-success btn-loaders btn-icon");
                $('#btn_Insert_Amity').html("Saving the Record....");
                var car_chkbox = "";
                $('.custom-control-input:checked').each(function (index) {
                    car_chkbox = car_chkbox + ',' + $(this).val();
                });
                var car_checkbox = car_chkbox.substring(1);
                var _dataInsert = {
                "car_Id": 0,
                "car_appId": @emr.appId,
                "car_checkbox": car_checkbox,
                "car_e1": $("#car_e1").text(),
                "car_e2": '',
                "car_e3": $("#car_e3").val(),
                "car_e4": $("#car_e4").val(),
                "car_e5": $('#car_e5').text(),
                "car_e6": $("#car_e6").val(),
                "car_e7": $("#car_e7").val(),
                "car_e8": $("#car_e8").val(),
                "car_e9": $("#car_e9").val(),
                "car_e10": $("#car_e10").val(),
                "car_e11": $("#car_e11").val(),
                "car_e12": $("#car_e12").val(),
                "car_e13": $("#car_e13").val(),
                "car_d1": moment($("#car_d1").val()).format("YYYY-MM-DD"),
                "car_d2": moment($("#car_d2").val()).format("YYYY-MM-DD"),
                "__RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val()
                }
                console.log(_dataInsert);
            $.ajax({
            type: "POST",
            url: "@Url.Action("InsertAmity", "Amity", new { area = "EMRForms" })",
            dataType: 'JSON',
            data: _dataInsert,
            success: function (data) {
                $('#btn_Insert_Amity').removeClass("btn btn-success btn-loaders btn-icon");
                $('#btn_Insert_Amity').addClass("btn btn-success");
                $('#btn_Insert_Amity').html("Add");

                if (data.isSuccess) {
                if (data.isInserted) {
                GetAmity();
                var alertPlaceholder = document.getElementById("Alert");
                function alert(e, t) {
                    var l = document.createElement("div");
                    l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" role="alert">' + e +
                        '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
                }
                alert("<i class='fe fe-check-circle text-white'></i> Amity Claim Form Added Successfully!", "success");
                Timeout();
                    EditAmity();
            }
                else {
                    let html = "<div class='col-12 col-sm-12 col-md-12 d-flex justify-content-center'>" +
                        "<div class='alert alert-light-warning' role='alert'>" +
                        "<button type='button' class='btn-close text-warning' style='margin-bottom:-5px;' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                        "<strong><i class='fa fa-exclamation-triangle text-warning'></i> Amity Claim Form Alredy Exists!</strong><br/>" +
                        "</div></div>";
                    $("#error").html(html);
                }
            }
            else {
            let html = "<div class='col-12 col-sm-12 col-md-12 d-flex justify-content-center'>" +
                "<div class='alert alert-light-danger' role='alert'>" +
                "<button type='button' class='btn-close text-danger' style='margin-bottom:-5px;' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                "<strong><i class='fa fa-ban text-danger'></i> Validation Error! Please validate before submitting.&nbsp;</strong><br/><ul>";

            $.each(data.message, function (index, value) {
                html += "<li><small>" + value + "</small><li>";
                var elem = $("#" + index);
                if (elem.hasClass("select2-hidden-accessible")) {
                    $("#select2-" + elem.attr("id") + "-container").parent().addClass('error');
                }
                else {
                    $(elem).addClass(" is-invalid");
                }

                setTimeout(function () {
                    if (elem.hasClass("select2-hidden-accessible")) {
                        $("#select2-" + elem.attr("id") + "-container").parent().removeClass('error');
                    }
                    else {
                        $(elem).removeClass("is-invalid");
                    }
                }, 5000);
            });
            html += "</ul></div></div>";
            $("#error").html(html);
            }
            },
            error: function (xhr) {
            $('#btn_Insert_Amity').removeClass("btn btn-success btn-loaders btn-icon");
            $('#btn_Insert_Amity').addClass("btn btn-success");
            $('#btn_Insert_Amity').html("Add");
            Timeout();
            }
            });
            }
            else {
                $('.modal-body').animate({
                    scrollTop: ($('.has-error').offset().top - 300)
                }, 2000);
            }
        });
    //#endregion

    //#region Load Get_Patient_Treatments_table
        var Get_AllPatientTreatments = function () {

            $.ajax({
                type: "GET",
                url: "@Url.Action("GetAllPatientTreatments", "ReimbursementForms", new { area = "EMRForms" })?appId=" + "@emr.appId" + "&patId=" + @emr.patId,
                success: function (response) {
                    if (response.isAuthorized != false) {
                        var table;
                        if ($.fn.dataTable.isDataTable('#tbl_Treatment')) {
                            table = $('#tbl_Treatment').DataTable();
                            table.clear();
                            table.rows.add(response).draw();
                        }
                        else {
                            BindDataTableP(response);
                        }
                    }
                    else {
                        console.log("You are not Authorized!");
                    }
                },
                error: function (xhr) {
                    console.log(xhr);
                }
            })
        }
    //#endregion

    //#region Bind Get_Patient_Treatments_table
        var BindDataTableP = function (response) {
            var table = $("#tbl_Treatment").DataTable({
                fixedHeader: {
                    header: true,
                    footer: true
                },
                processing: true,
                "deferRender": true,
                "retrieve": true,
                lengthChange: true,
                "aaData": response,
                "aoColumns": [
                    {
                        "mData": "ptId",
                        "orderable": false,
                        "searchable": false,
                        "className": "text-center",
                        "render": function (data, type, row, meta) {
                            let _index = (meta.row) + 1;
                            if (_index >= 10) {
                                return "<a href='javascript:void(0)' class='fs-13 font-weight-bold'>" + _index + "</a>";
                            }
                            else {
                                return "<a href='javascript:void(0)' class='fs-13 font-weight-bold'>0" + _index + "</a>";
                            }
                        }
                    },
                    {
                        "mData": "tr_code",
                        "className": 'text-justify text-wrap'
                    },
                    {
                        "mData": "tr_name",
                        "className": 'text-justify text-wrap'
                    },
                    {
                        "mData": "pt_qty",
                        "className": 'text-justify text-wrap'
                    },
                    {
                        "mData": "tr_type",
                        "className": 'text-justify text-wrap'
                    },

                    {
                         "mData": "tr_price",
                        "className": 'text-justify text-wrap'
                    },
                ],
                order: [[0, 'asc']],
                scrollX: true,
                scrollY: 500,
                scrollCollapse: true,
            });
        };
    //#endregion
</script>
@*}*@
