
@model BusinessEntities.EMRForms.ArabOrient
@using System.Linq;
@using System.Security.Claims;
@using BusinessEntities;
@{
    var claims = ClaimsPrincipal.Current.Identities.First().Claims.ToList();
    var emp_designation = claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value).SingleOrDefault();
    EMRInfo emr = (EMRInfo)TempData["emr_data"];
    TempData.Keep("emr_data");
}

<form id="form_ArabOrientDecision" autocomplete="off" name="ArabOrient" ondrop="return false;" onpaste="return false;" oncut="return false;" class="fs-14">
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.caonId, new { @id = "caonId", @value = "@Model.caonId" })
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12 text-center">
            <img src="~/images/Reimbursement_Forms/arab.png" />
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12 text-center">
            <h1 class="font-weight-bold text-center">Professional Indemnity for Medical Practitioners</h1>
        </div>
    </div>

    <!-- Row -->
    <div class="row">
        <div class="col-lg-12 col-xl-12 col-md-12 col-sm-12">
            <div class="card">
                <div class="card-header">
                    <h6 class="card-title">
                        I. General Data
                    </h6>
                </div>
                <div class="card-body pb-0">
                    <div class="form-horizontal">
                        <div class="form-group row">
                            <div class="d-flex col-sm-12 col-md-12 col-lg-12">
                                <label class="col-md-3 text-justify text-black">1. Full Name</label>
                                <div class="d-flex  justify-content-center w-8  text-justify text-black">
                                    :
                                </div>
                                <div class="col-md-6">
                                    @Html.TextBoxFor(m => m.caon_1, new { @class = "form-control", @id = "caon_1", @maxlength = "20" })&nbsp;
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="d-flex col-sm-12 col-md-12 col-lg-12">
                                <label class="col-md-3 text-justify text-black">2. Business Address</label>
                                <div class="d-flex  justify-content-center w-8  text-justify text-black">
                                    :
                                </div>
                                <div class="col-md-6">
                                    @Html.TextBoxFor(m => m.caon_2, new { @class = "form-control", @id = "caon_2", @maxlength = "20" })&nbsp;
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="d-flex col-sm-12 col-md-12 col-lg-12">
                                <label class="col-md-3 text-justify text-black">3. UAE Medical Association No.</label>
                                <div class="d-flex  justify-content-center w-8  text-justify text-black">
                                    :
                                </div>
                                <div class="col-md-6">
                                    @Html.TextBoxFor(m => m.caon_3, new { @class = "form-control", @id = "caon_3", @maxlength = "20" })&nbsp;
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="d-flex col-sm-12 col-md-12 col-lg-12">
                                <label class="col-md-3 text-justify text-black">4. Required Limit of Indemnity</label>
                                <div class="d-flex  justify-content-center w-8  text-justify text-black">
                                    :
                                </div>
                                <div class="col-md-6">
                                    @Html.TextBoxFor(m => m.caon_4, new { @class = "form-control", @id = "caon_4", @maxlength = "20" })&nbsp;
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-12 col-md-12 col-lg-12">
                                <label class="col-md-12 text-justify text-black">5. a. At what medical school / university did the proposer graduate and when?</label>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.caon_5, new { @class = "form-control", @id = "caon_5", @maxlength = "20" })&nbsp;
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-12 col-md-12 col-lg-12">
                                <label class="col-md-12 text-justify text-black"> b. Professional Qualification Acquire</label>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.caon_6, new { @class = "form-control", @id = "caon_6", @maxlength = "20" })&nbsp;
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-12 col-md-12 col-lg-12">
                                <label class="col-md-12 text-justify text-black"> 6. Where and when has the proposer practiced his profession since graduation?</label>
                                <div class="col-md-12">
                                    @Html.TextBoxFor(m => m.caon_7, new { @class = "form-control", @id = "caon_7", @maxlength = "20" })&nbsp;
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="card-header">
                    <h4 class="card-title">II. Nature and Volume of your present and foreseeable future activities</h4>
                </div>
                <div class="card-body ps-6">
                    <div class="form-horizontal">
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">1. The proposer is practising as</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_8, new { @class = "form-control", @id = "caon_8", @maxlength = "20" })&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">2. Name (s) of qualified medical assistant(s) / technician(s)</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_9, new { @class = "form-control", @id = "caon_9", @maxlength = "20" })&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">3. Number of technicians employed</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_10, new { @class = "form-control", @id = "caon_10", @maxlength = "20" })&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">4. Number of nurses employed</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_11, new { @class = "form-control", @id = "caon_11", @maxlength = "20" })&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">5. Is the proposer under contract with or employed by any individual, firm or corporation? If so please give details.</label>
                            <div class="col-md-12">
                                @Html.TextAreaFor(m => m.caon_12, new { @class = "form-control", @row = "2", @id = "caon_12" })
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">6. Does the proposer own, wholly or in part, operate or administer any hospital, nursing home or other institution? If so, please give details including number of reserved beds.</label>
                            <div class="col-md-12">
                                @Html.TextAreaFor(m => m.caon_13, new { @class = "form-control", @row = "2", @id = "caon_13" })
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">7. Does the proposer own or operate x-ray machine or laser? If so, please give number, type and whether they are used for diagnosis or treatment or both</label>
                            <div class="col-md-12">
                                @Html.TextAreaFor(m => m.caon_14, new { @class = "form-control", @row = "2", @id = "caon_14" })
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">8.  Number of patients per year</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_15, new { @class = "form-control", @maxlength = "20", @id = "caon_15" })
                            </div>
                        </div>

                    </div>
                </div>
                <div class="card-header">
                    <h4 class="card-title">III. Previous Insurance / Previous Claims</h4>
                </div>
                <div class="card-body ps-6">
                    <div class="form-horizontal">
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">1.  If the proposer has been previously insured please specify:</label>
                        </div>
                        <div class="form-group row ps-4">
                            <label class="col-md-12 text-justify text-black">Name of the Insurer</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_16, new { @class = "form-control", @id = "caon_16", @maxlength = "20" })&nbsp;
                            </div>
                        </div>
                        <div class="form-group row ps-4">
                            <label class="col-md-12 text-justify text-black">Policy Period</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_17, new { @class = "form-control", @id = "caon_17", @maxlength = "20" })&nbsp;
                            </div>
                        </div>
                        <div class="form-group row ps-4">
                            <label class="col-md-12 text-justify text-black">Limit of Indemnity</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_18, new { @class = "form-control", @id = "caon_18", @maxlength = "20" })&nbsp;
                            </div>
                        </div>
                        <div class="form-group row ps-4">
                            <label class="col-md-12 text-justify text-black">Deductible</label>
                            <div class="col-md-12">
                                @Html.TextBoxFor(m => m.caon_19, new { @class = "form-control", @id = "caon_19", @maxlength = "20" })&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">2. Has a previous application been declined?</label>
                            <div class="col-md-6 d-flex">
                                <label class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" name="cir_checkbox[1]" value="1">
                                    <span class="custom-control-label">Yes</span>
                                </label>&nbsp;
                                <label class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" name="cir_checkbox[1]" value="2">
                                    <span class="custom-control-label">No</span>
                                </label>&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">3. Has a previous Insurer required increased premium or special restrictions?</label>
                            <div class="col-md-3 d-flex">
                                <label class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" name="cir_checkbox[3]" value="3">
                                    <span class="custom-control-label">Yes</span>
                                </label>&nbsp;
                                <label class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" name="cir_checkbox[3]" value="4">
                                    <span class="custom-control-label">No</span>
                                </label>&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">4. Has a previous insurance been terminated / not been renewed by an Insurer?</label>
                            <div class="col-md-6 d-flex">
                                <label class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" name="cir_checkbox[5]" value="5">
                                    <span class="custom-control-label">Yes</span>
                                </label>&nbsp;
                                <label class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" name="cir_checkbox[5]" value="6">
                                    <span class="custom-control-label">No</span>
                                </label>&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-6 text-justify text-black">If so, please give detailed information</label>
                            <div class="col-md-12">
                                @Html.TextAreaFor(m => m.caon_20, new { @class = "form-control", @row = "2", @id = "caon_20" })
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">5. Have any claims or suits for malpractice been made against the proposer or any of his partners, assistants, nurses or technicians during the past five years?</label>
                            <div class="col-md-6 d-flex">
                                <label class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" name="cir_checkbox[7]" value="7">
                                    <span class="custom-control-label">Yes</span>
                                </label>&nbsp;
                                <label class="custom-control custom-radio">
                                    <input type="radio" class="custom-control-input" name="cir_checkbox[7]" value="8">
                                    <span class="custom-control-label">No</span>
                                </label>&nbsp;
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-12 text-justify text-black">if so, please advise amount and background of each claim.</label>
                            <div class="col-md-12">
                                @Html.TextAreaFor(m => m.caon_21, new { @class = "form-control", @row = "2", @id = "caon_21" })
                            </div>
                        </div>
                        <div class="form-group row">
                            <p class="text-justify text-black">I declare that the statement and particulars in this proposal are true and that I have not misstated or suppressed any material facts. I agree that this proposal, together with any other information supplied by me, shall form the basis of any contract of insurance effected thereon. Signing this proposal form does not bind the proposer or the Company to complete this insurance.</p>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-4 text-black">Date.</label>
                            <div class="col-md-6">
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <div class="input-group-text">
                                            <i class="fe fe-calendar"></i>
                                        </div>
                                    </div>
                                    @Html.TextBoxFor(m => m.caon_22, new { @class = "form-control", @placeholder = "DD-MMMM-YYYY", @id = "caon_22" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="text-black">Sign & Stamp</label>
                            <div class="col-md-12">
                                <img alt="stamp" src="@emr.doc_sign" id="doc_sign" class="avatar avatar-xl bsquare" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Row -->

    <div class="row ">
        <div class="row mt-2">
            <div class="col-sm-12 col-md-12 col-lg-12 text-center">
                <div class="btn-list btn-animation">
                    <button type="submit" class="btn btn-success" id="btn_Insert_ArabOrient">Save</button>
                    <button type="button" class="btn btn-outline-dark" id="btn_Reset_ArabOrient">Reset</button>
                    <button type="button" class="btn btn-outline-danger me-1" id="btn_Close_ArabOrient" style="display:none">
                        Close
                    </button>
                    <div class="btn-group mr-2">
                        <div class="dropdown">
                            <button type="button" class="btn-sm btn-secondary me-2 mb-2 dropdown-toggle" data-bs-toggle="dropdown">
                                <i class="fa fa-paint-brush">&nbsp;&nbsp;</i> Patient
                            </button>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" onclick="openSignaturePad('patient')">Tab</a>
                                <a class="dropdown-item" onclick="openWacomTabSignaturePad('patient')">Wacom Tab</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
@*@section myScripts{*@
<script type="text/javascript">
    //#region Page Load
        var formName1 = $(form_ArabOrientDecision).closest('form').attr('name');
        $(function () {
            set_date();
            validate();
        });
    //#endregion

    //#region Validation Initialization
        var validate = function () {
            $('#caon_22').keypress(function (e) {
                var charCode = (e.which) ? e.which : e.keyCode
                if (String.fromCharCode(charCode).match(/[^0-9./-]/g)) {
                    return false;

                }
                else {
                    if (e.target.value.length >= 18)
                        return false;
                }
            });
        }
    //#endregion Validation Initialization

    //#region Load set Date
        var set_date = function () {
            $('#caon_22').bootstrapdatepicker({
                    format: "dd-MM-yyyy",
                    viewMode: "date",
                    todayHighlight: true,
                    autoclose: true,
                    multidate: false,
                    multidateSeparator: "-"
            });
            $("#caon_22").bootstrapdatepicker("setDate", '');
        }
    //#endregion

    //#region Wacom Tab Signature
        var openWacomTabSignaturePad = function (id) {
            var _data = {
                "patId": @emr.patId,
                "person": id,
                "form": "ArabOrient",
                "appId": @emr.appId,
                "formname":"ArabOrient",
                "formlink":"PrintArabOrientClaim.aspx",
                "eSign":""
            }
            $.ajax({
                type: "GET",
                url: "@Url.Action("WacomTabSignaturePad", "WacomTabSignaturePad", new { area = "Common" })",
                contentType: "application/json",
                dataType: "html",
                data: _data,
                success: function (response) {
                    $("#signature_pad_body").html(response);
                    $("#signature_pad").modal("show");
                },
                error: function (xhr) {
                    console.log("Error :" + xhr.statusText);
                }
            });
        }
    //#endregion

    //#region Signature
        var openSignaturePad = function (id) {
            var _data = {
                "patId": @emr.patId,
                "person": id,
                "form": "ArabOrient",
                "appId": @emr.appId,
                "formname":"ArabOrient",
                "formlink":"PrintArabOrientClaim.aspx",
                "eSign":""
            }
            $.ajax({
                type: "GET",
                url: "@Url.Action("SignaturePad", "SignaturePad", new { area = "Common" })",
                contentType: "application/json",
                dataType: "html",
                data: _data,
                success: function (response) {
                    $("#signature_pad_body").html(response);
                    $("#signature_pad").modal("show");
                },
                error: function (xhr) {
                    console.log("Error :" + xhr.statusText);
                }
            });
        }
    //#endregion

    //#region Reset
        $('#btn_Reset_ArabOrient').on('click', function (e) {
            e.preventDefault();
            clearControls();
        });
    //#endregion

    //#region Clear Controls
        var clearControls = function () {
        $("#caon_1").val("");
        $("#caon_2").val("");
        $("#caon_3").val("");
        $("#caon_4").val("");
        $("#caon_5").val("");
        $("#caon_6").val("");
        $("#caon_7").val("");
        $("#caon_8").val("");
        $("#caon_9").val("");
        $("#caon_10").val("");
        $("#caon_11").val("");
        $("#caon_12").val("");
        $("#caon_13").val("");
        $("#caon_14").val("");
        $("#caon_15").val("");
        $("#caon_16").val("");
        $("#caon_17").val("");
        $("#caon_18").val("");
        $("#caon_19").val("");
        $("#caon_20").val("");
        $("#caon_21").val("");
        $("#caon_22").bootstrapdatepicker("setDate", '');
        var elements = document.getElementsByClassName('custom-control-input');
        Array.prototype.forEach.call(elements, function (element) {
            element.checked = false;
        });
    }
    //#endregion

    //#region Insert Button Click
        $('#btn_Insert_ArabOrient').on('click', function (e) {
            e.preventDefault();
            if ($("#form_ArabOrientDecision").valid()) {
                $('#btn_Insert_ArabOrient').removeClass("btn btn-success");
                $('#btn_Insert_ArabOrient').addClass("btn btn-success btn-loaders btn-icon");
                $('#btn_Insert_ArabOrient').html("Saving the Record....");
                var caon_chkbox = "";
                $('.custom-control-input:checked').each(function (index) {
                    caon_chkbox = caon_chkbox + ',' + $(this).val();
                });
                var caon_checkbox = caon_chkbox.substring(1);
                var _dataInsert = {
                "caonId": 0,
                "caon_appId": @emr.appId,
                "caon_1": $("#caon_1").val(),
                "caon_2": $("#caon_2").val(),
                "caon_3": $("#caon_3").val(),
                "caon_4": $("#caon_4").val(),
                "caon_5": $("#caon_5").val(),
                "caon_6": $("#caon_6").val(),
                "caon_7": $("#caon_7").val(),
                "caon_8": $("#caon_8").val(),
                "caon_9": $("#caon_9").val(),
                "caon_10": $("#caon_10").val(),
                "caon_11": $("#caon_11").val(),
                "caon_12": $("#caon_12").val(),
                "caon_13": $("#caon_13").val(),
                "caon_14": $("#caon_14").val(),
                "caon_15": $("#caon_15").val(),
                "caon_16": $("#caon_16").val(),
                "caon_17": $("#caon_17").val(),
                "caon_18": $("#caon_18").val(),
                "caon_19": $("#caon_19").val(),
                "caon_20": $("#caon_20").val(),
                "caon_21": $("#caon_21").val(),
                "caon_chk": caon_checkbox,
                "caon_22": moment($("#caon_22").val()).format("YYYY-MM-DD"),
                "caon_date2": moment($("#caon_date2").val()).format("YYYY-MM-DD"),
                "__RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val()
                }
                console.log(_dataInsert);
            $.ajax({
            type: "POST",
            url: "@Url.Action("InsertArabOrient", "ReimbursementForms", new { area = "EMRForms" })",
            dataType: 'JSON',
            data: _dataInsert,
            success: function (data) {
            $('#btn_Insert_ArabOrient').removeClass("btn btn-success btn-loaders btn-icon");
            $('#btn_Insert_ArabOrient').addClass("btn btn-success");
            $('#btn_Insert_ArabOrient').html("Add");

            if (data.isSuccess) {
            if (data.isInserted) {
            GetArabOrient();
            var alertPlaceholder = document.getElementById("Alert");
            function alert(e, t) {
                var l = document.createElement("div");
                l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" role="alert">' + e +
                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
            }
            alert("<i class='fe fe-check-circle text-white'></i> ArabOrient Claim Form Added Successfully!", "success");
            Timeout();
            EditArabOrient()
            }
                else {
                    let html = "<div class='col-12 col-sm-12 col-md-12 d-flex justify-content-center'>" +
                        "<div class='alert alert-light-warning' role='alert'>" +
                        "<button type='button' class='btn-close text-warning' style='margin-bottom:-5px;' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                        "<strong><i class='fa fa-exclamation-triangle text-warning'></i> ArabOrient Claim Form Alredy Exists!</strong><br/>" +
                        "</div></div>";
                    $("#error").html(html);
                }
            }
            else {
            let html = "<div class='col-12 col-sm-12 col-md-12 d-flex justify-content-center'>" +
                "<div class='alert alert-light-danger' role='alert'>" +
                "<button type='button' class='btn-close text-danger' style='margin-bottom:-5px;' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                "<strong><i class='fa fa-ban text-danger'></i> Validation Error! Please validate before submitting.&nbsp;</strong><br/><ul>";

            $.each(data.message, function (index, value) {
                html += "<li><small>" + value + "</small><li>";
                var elem = $("#" + index);
                if (elem.hasClass("select2-hidden-accessible")) {
                    $("#select2-" + elem.attr("id") + "-container").parent().addClass('error');
                }
                else {
                    $(elem).addClass(" is-invalid");
                }

                setTimeout(function () {
                    if (elem.hasClass("select2-hidden-accessible")) {
                        $("#select2-" + elem.attr("id") + "-container").parent().removeClass('error');
                    }
                    else {
                        $(elem).removeClass("is-invalid");
                    }
                }, 5000);
            });
            html += "</ul></div></div>";
            $("#error").html(html);
            }
            },
            error: function (xhr) {
            $('#btn_Insert_ArabOrient').removeClass("btn btn-success btn-loaders btn-icon");
            $('#btn_Insert_ArabOrient').addClass("btn btn-success");
            $('#btn_Insert_ArabOrient').html("Add");
            Timeout();
            }
            });
            }
            else {
                $('.modal-body').animate({
                    scrollTop: ($('.has-error').offset().top - 300)
                }, 2000);
            }
        });
    //#endregion

</script>
@*}*@