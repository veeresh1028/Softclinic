

@model BusinessEntities.EMRForms.EmiratesDental
@using System.Linq;
@using System.Security.Claims;
@using BusinessEntities;
@{
    ViewBag.Title = "Print EmiratesDental Reimbursement Claim Form";
    Layout = "~/Areas/EMR/Views/Shared/_EMR_Layout.cshtml";

    var claims = ClaimsPrincipal.Current.Identities.First().Claims.ToList();
    var emp_designation = claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value).SingleOrDefault();
    EMRInfo emr = (EMRInfo)TempData["emr_data"];
    TempData.Keep("emr_data");
}
<div class="row mb-2 mt-2 text-center">
    <div class="col-md-12">
        <button id="btnPrint" type="button" onclick="printDiv('printDiv')" class="btn btn-primary d-print-none"><i class="si si-printer"></i> Print</button>
    </div>
</div>
<div class="row fs-14" id="printDiv">
    <div class="col-md-12">
        <div class="card overflow-hidden">
            <div class="card-body">
                <div class="text-center">
                    <img src="@Model.set_header_image" />
                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12 text-center ps-6">
                        <p class="text-black text-justify font-weight-bold">
                            Submit your completed claim form and supporting documents online:
                        </p>
                        <p class="text-black text-justify font-weight-bold">
                            HRDirect > Profile > Remuneration & Benefits > Medical Benefits > Member Portal > Submit Reimbursement claim
                        </p>
                    </div>
                </div>
                <div>
                    <hr class="new4" />
                </div>
                <!-- End Row-->
                <div class="row">
                    <div class="col-lg-12 col-xl-12 col-md-12 col-sm-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title text-success font-weight-bold">Section A - Employee Details</h4>
                            </div>
                            <div class="card-body pb-0">
                                <div class="form-horizontal">
                                    <div class="form-group row">
                                        <label class="col-md-2 form-label">Name of Employee:</label>
                                        <div class="col-md-3">
                                            <span class="font-weight-normal1 text-capitalize text-left">@emr.doc_name&nbsp;</span>
                                        </div>
                                        <label class="col-md-2 form-label">	Staff Number:</label>
                                        <div class="col-md-3">
                                            <label class="text-black text-left">@Model.emdn_31&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <hr class="new4" />
                            </div>
                            <div class="card-header">
                                <h4 class="card-title text-success font-weight-bold">Section B – Patient Medical Details (To be fully completed by treating dentist)</h4>
                            </div>
                            <div class="card-body pb-0">
                                <div class="form-horizontal">
                                    <div class="form-group row">
                                        <label class="col-md-2 form-label">Patient Name:</label>
                                        <div class="col-md-3">
                                            <span class="font-weight-normal1 text-capitalize text-left">@emr.pat_name&nbsp;</span>
                                        </div>
                                        <label class="col-md-2 form-label">	Date Of Birth:</label>
                                        <div class="col-md-3">
                                            <span class="font-weight-normal1 text-capitalize text-left">@emr.pat_dob&nbsp;</span>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="text-black">Complaints / Onset / History</label>
                                        <div class="col-md-12">
                                            <label class="text-black text-red text-left" id="complaints" name="">&nbsp;</label>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="text-black">Diagnosis</label>
                                        <div class="col-md-12">
                                            <label class="text-black text-red text-left" id="diagnosis" name="">&nbsp;</label>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="text-black">Mark the affected tooth with <span class="font-weight-bold">“X”</span> and specify diagnosis details in the above field</label>
                                    </div>
                                    <div class="form-group row">
                                        <div class="table-responsive">
                                            <table id="tbl_1" class="table table-striped table-bordered text-nowrap" style="width: 100%; cursor: pointer;">
                                                <thead>
                                                    <tr style="color: #fff !important; background-color: #808080; border-color: #3C457D;">
                                                        <th class="border-bottom-0 font-weight-semibold text-white">1</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">2</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">3</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">4</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">5</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">6</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">7</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">8</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">9</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">10</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">11</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">12</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">13</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">14</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">15</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">16</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_3&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_4&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_5&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_6&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_7&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_8&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_9&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_10&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_11&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_12&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_13&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_14&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_15&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_16&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_17&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_18&nbsp;</label></td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="16"><hr class="new4" /></td>
                                                    </tr>
                                                    <tr>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_19&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_20&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_21&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_22&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_23&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_24&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_25&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_26&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_27&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_28&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_29&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_30&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_31&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_32&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_33&nbsp;</label></td>
                                                        <td><label class="text-black text-left text-uppercase">@Model.emdn_34&nbsp;</label></td>
                                                    </tr>
                                                </tbody>
                                                <thead>
                                                    <tr style="color: #fff !important; background-color: #808080; border-color: #3C457D;">
                                                        <th class="border-bottom-0 font-weight-semibold text-white">32</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">31</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">30</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">29</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">28</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">27</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">26</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">25</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">24</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">23</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">22</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">21</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">20</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">19</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">18</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">17</th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="text-black">Planned Treatment</label>
                                        <div class="col-md-12">
                                            <label class="text-black text-left">@Model.emdn_35&nbsp;</label>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="text-black">Signature and Stamp</label>
                                        <div class="col-md-12">
                                            <p class="text-black text-justify">
                                                I declare that I am the patient’s treating doctor/dentist and that theparticulars given are to the best of my knowledge true and correct
                                            </p>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <div class="col-md-12 text-right">
                                            <img alt="stamp" src="@emr.doc_sign" id="doc_sign" class="avatar avatar-xl bsquare" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <hr class="new4" />
                            </div>
                            <div class="card-header">
                                <h4 class="card-title text-success font-weight-bold">Section C – Patient / Spouse / Guardian Signature</h4>
                            </div>
                            <div class="card-body pb-0">
                                <div class="form-horizontal">
                                    <div class="form-group row">
                                        <p class="text-black text-justify">
                                            I hereby authorise the Emirates Group to obtain any and all medical records, reports and test results, either in original hard-copy form or via access to
                                            electronic data systems, as may be required to validate my claim. I consent to the Emirates Group disclosing my medical records, reports and test results
                                            for the purpose of processing and validating my claim. In addition, I understand any such medical information provided to the Emirates Group will be
                                            accessible to Emirates Group employees (including employees of wholly owned subsidiaries) on the Emirates Medical Benefits System Employee Portal via
                                            confidential log-in.
                                        </p>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-md-2 form-label">signature:</label>
                                        <div class="col-md-3">
                                            <div class="form-group mb-3" style="display:none" id="upatimg"><img alt="Signature" src="" id="upat_sign" class="avatar avatar-xl bsquare" /></div>
                                        </div>
                                        <label class="col-md-2 form-label">	Date:</label>
                                        <div class="col-md-3">
                                            <label class="form-label text-red text-left" id="upsb_date_witness" name="">&nbsp;</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <hr class="new4" />
                            </div>
                            <div class="card-header">
                                <h4 class="card-title text-success font-weight-bold">Section D – Employee Checklist (* Mandatory Fields)</h4>
                            </div>
                            <div class="card-body pb-0">
                                <div class="form-horizontal">
                                    <div class="form-group row">
                                        <div class="table-responsive">
                                            <table id="tbl_1" class="table table-striped table-bordered text-nowrap" style="width: 30%; cursor: pointer;">
                                                <thead>
                                                    <tr style="color: #fff !important; background-color: #808080; border-color: #3C457D;">
                                                        <th class="border-bottom-0 font-weight-semibold text-white">Employee check</th>
                                                        <th class="border-bottom-0 font-weight-semibold text-white">Documents Submitted</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>
                                                            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                                                                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                                                                    <input type="checkbox" class="custom-control-input" name="emdn_check" value="1" id="1">
                                                                    <span class="custom-control-label"></span>
                                                                </label>
                                                            </div>
                                                        </td>
                                                        <td>Claim form</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                                                                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                                                                    <input type="checkbox" class="custom-control-input" name="emdn_check" value="2" id="2">
                                                                    <span class="custom-control-label"></span>
                                                                </label>
                                                            </div>
                                                        </td>
                                                        <td>Payment receipts with costs breakdown</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                                                                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                                                                    <input type="checkbox" class="custom-control-input" name="emdn_check" value="3" id="3">
                                                                    <span class="custom-control-label"></span>
                                                                </label>
                                                            </div>
                                                        </td>
                                                        <td>Copy of x-ray film (.pdf)</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                                                                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                                                                    <input type="checkbox" class="custom-control-input" name="emdn_check" value="4" id="4">
                                                                    <span class="custom-control-label"></span>
                                                                </label>
                                                            </div>
                                                        </td>
                                                        <td>Medical report and prescription</td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                                                                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                                                                    <input type="checkbox" class="custom-control-input" name="emdn_check" value="5" id="5">
                                                                    <span class="custom-control-label"></span>
                                                                </label>
                                                            </div>
                                                        </td>
                                                        <td>EK referral (for EK Dental Clinic members)</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Row -->
                <div class="text-center">
                    <img src="@Model.set_footer_image" />
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    //#region Partial View Onload
        $(function () {
            Get_EMRINFO();
            GetSignaturename('patient');
            GetCheckedValues("@Model.emdn_chk");
        });
    //#endregion

    //#region Get CheckedValues
        var GetCheckedValues = function (checknames) {
            var str = checknames;
            var myarray = str.split(',');

            for (var i = 0; i < myarray.length; i++) {
                $('.custom-control-input').each(function () {
                    if (this.id == myarray[i]) {
                        $("#" + this.id).attr('checked', 'checked');
                        $("#" + this.id).prop("checked", true);

                    }
                });
            }

        }
    //#endregion

    //#region Print
        function printDiv(divName) {
            var printContents = document.getElementById(divName).innerHTML;
            var originalContents = document.body.innerHTML;
            document.body.innerHTML = printContents;
            window.print();
            document.body.innerHTML = originalContents;
        }
    //#endregion

    //#region Get Signature
        var GetSignaturename = function  (person) {
            $.ajax({
                url: '@Url.Action("GetSignature", "SignaturePad", new { area = "Common" })?appId=' + @emr.appId + '&person=' + person + '&form=EmiratesDental',
                    type: "GET",
                    dataType: "json",
                    async: false,
                success: function (response) {
                    console.log("fgxghszd");
                    console.log(response);
                    let sign = response[0].psb_sign;
                    var date = moment(response[0].psb_date_created).format("DD-MM-YYYY HH:mm");
                    if (response[0].person == "patient") {
                        $("#upatimg").show();
                        $("#upat_sign").attr("src", sign);
                        $("#upsb_date_witness").text(date);
                    }
                },
                error: function (xhr) {
                    console.log(xhr);
                    alert(xhr);
                }

            });
        };
    //#endregion

     //#region Load Get Diagnosis,treatments,history,invoice
         var Get_EMRINFO = function () {
             $.ajax({
                 type: "GET",
                 url: "@Url.Action("GetEmrInfo", "ReimbursementForms", new { area = "EMRForms" })?appId=" + "@emr.appId" + "&patId=" + @emr.patId,
                 success: function (response) {
                     if (response.length > 0) {
                         $('#diagnosis').text(response[0].diagnosis);
                         $('#complaints').text(response[0].complaints + '/' + response[0].past);
                     }
                 },
                 error: function (xhr) {
                     console.log(xhr);
                 }
             })
         }
     //#endregion

</script>
<style>
    hr.new4 {
        border: 5px solid #5A5A5A;
        margin-top: 0px;
        margin-bottom: 0px;
    }
</style>