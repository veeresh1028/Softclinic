
@model BusinessEntities.EMRForms.Adnic
@using System.Linq;
@using System.Security.Claims;
@using BusinessEntities;
@{
    var claims = ClaimsPrincipal.Current.Identities.First().Claims.ToList();
    var emp_designation = claims.Where(c => c.Type == ClaimTypes.Role).Select(c => c.Value).SingleOrDefault();
    EMRInfo emr = (EMRInfo)TempData["emr_data"];
    TempData.Keep("emr_data");
}

<form id="form_AdnicDecision" autocomplete="off" name="Adnic" ondrop="return false;" onpaste="return false;" oncut="return false;" class="fs-14">
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.adsId, new { @id = "uadsId", @value = "@Model.adsId" })
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12 d-flex justify-content-center">
            <div class="form-group mb-3"><label class="form-label"> Voucher No :&nbsp;</label></div>
            <div class="form-group mb-3">
                @Html.TextBoxFor(m => m.ads_voucher, new { @class = "form-control", @placeholder = "Enter Voucher No", @id = "ads_voucher", @width = "20px", @maxlength = "20" })&nbsp;
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12 mb-4">
            <div class="form-group mb-3" style="text-align: center;"><label class="form-label text-red text-align-center"> Please read the instructions & guidelines on overleaf before filling the form&nbsp;</label></div>
        </div>
    </div>
    <div class="row">
        <div class="panel-heading bg-azure-light text-white font-weight-bold">1. Patient Details</div>
        <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
            <div class="col-sm-11 col-md-6 col-lg-4">
                <label class="form-label ">
                    Patient's Name&nbsp;
                </label>
            </div>
            <div class="align-items-center justify-content-center w-8  form-label">
                :
            </div>
            <div class="col-sm-12 col-md-6 col-lg-7 mb-2">
                <span class="text-capitalize text-left text-black">@emr.pat_name&nbsp;</span>
            </div>
        </div>
        <div class="d-flex col-sm-12 col-md-6 col-lg-6 mt-2">
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label mb-2">Patient Health Card No</label>
            </div>
            <div class="align-items-center justify-content-center w-8  form-label">
                :
            </div>
            <div class="col-sm-12 col-md-6 col-lg-7 mb-2">
                @if (@emr.pi_insno != "")
                {
                    <span class="font-weight-normal1 text-capitalize text-left">@emr.pi_insno&nbsp;</span>
                }
                else
                {
                    <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                }
            </div>
        </div>
    </div>
    <div class="row">
        <div class="d-flex col-sm-12 col-md-6 col-lg-6">
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label mb-2">
                    Group Member's Name&nbsp;<span class="text-red">*</span>
                </label>
            </div>
            <div class="align-items-center justify-content-center w-8  form-label">
                :
            </div>
            <div class="col-sm-12 col-md-7 col-lg-7 mb-2">
                @Html.TextBoxFor(m => m.ads_group_mem, new { @class = "form-control", @placeholder = "Enter Group Member's Name", @id = "ads_group_mem", @width = "20px", @maxlength = "30" })
            </div>
        </div>
        <div class="d-flex col-sm-12 col-md-6 col-lg-6">
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label">Type of Plan</label>
            </div>
            <div class="align-items-center justify-content-center w-8  form-label">
                :
            </div>
            <div class="col-sm-12 col-md-7 col-lg-7 mb-2">
                @if (@emr.app_ic_name != "")
                {
                    <span class="font-weight-normal1 text-capitalize text-left">@emr.app_ic_name&nbsp;</span>
                }
                else
                {
                    <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                }
            </div>
        </div>
    </div>
    <div class="row">
        <div class="d-flex col-sm-12 col-md-6 col-lg-6">
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label">
                    Employer's Name&nbsp;
                </label>
            </div>
            <div class="align-items-center justify-content-center w-8  form-label">
                :
            </div>
            <div class="col-sm-12 col-md-7 col-lg-7 mb-2">
                @if (@emr.doc_name != "")
                {
                    <span class="text-capitalize text-left text-black">@emr.doc_name&nbsp;</span>
                }
                else
                {
                    <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                }
            </div>
        </div>
        <div class="d-flex col-sm-12 col-md-6 col-lg-6">
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label">Telephone No</label>
            </div>
            <div class="align-items-center justify-content-center w-8  form-label">
                :
            </div>
            <div class="col-sm-12 col-md-7 col-lg-7 mb-2">
                @if (@emr.pat_mob != "")
                {
                    <span class="text-capitalize text-left text-black">@emr.pat_mob&nbsp;</span>
                }
                else
                {
                    <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                }
            </div>
        </div>
    </div>
    <div class="row">
        <div class="d-flex col-sm-12 col-md-6 col-lg-6">
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label">Date of Birth</label>
            </div>
            <div class="align-items-center justify-content-center w-8 form-label">
                :
            </div>
            <div class="col-sm-12 col-md-7 col-lg-7 mb-2">
                @if (@emr.pat_dob != "")
                {
                    <span class="text-capitalize text-left text-black">@emr.pat_dob&nbsp;</span>
                }
                else
                {
                    <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                }
            </div>
        </div>
        <div class="d-flex col-sm-12 col-md-6 col-lg-6">
            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label">Address</label>
            </div>
            <div class="align-items-center justify-content-center w-8  form-label">
                :
            </div>
            <div class="col-sm-12 col-md-7 col-lg-7 mb-2">
                @if (@emr.pat_address != "")
                {
                    <span class="text-capitalize text-left text-black">@emr.pat_address&nbsp;</span>
                }
                else
                {
                    <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                }
            </div>

        </div>
    </div>
    <div class="row">
        <div class="d-flex col-sm-12 col-md-6 col-lg-6">

            <div class="col-sm-12 col-md-6 col-lg-4">
                <label class="form-label">
                    Email ID&nbsp;
                </label>
            </div>
            <div class="align-items-center justify-content-center w-8  form-label">
                :
            </div>
            <div class="col-sm-12 col-md-6 col-lg-7 mb-2">
                @if (@emr.pat_email != "")
                {
                    <span class="text-capitalize text-left text-black">@emr.pat_email&nbsp;</span>
                }
                else
                {
                    <span class="font-weight-normal1 text-capitalize text-left">N/A</span>
                }
            </div>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-3">
        </div>

    </div>
    <div class="row">
        <div class="panel-heading bg-azure-light text-white font-weight-bold" role="alert">2. Reason for not using listed healathcare facilities(Kindly indicate)</div>
        <div class="col-sm-3 col-md-4 col-lg-3 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ads_reason" value="Emergency" id="1">
                    <span class="custom-control-label">Emergency</span>
                </label>
            </div>
        </div>
        <div class="col-sm-3 col-md-4 col-lg-3 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ads_reason" value="Elective" id="2">
                    <span class="custom-control-label">Elective</span>
                </label>
            </div>
        </div>
        <div class="col-sm-3 col-md-4 col-lg-3 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ads_reason" value="Service Not Available" id="3">
                    <span class="custom-control-label">Service Not Available</span>
                </label>
            </div>
        </div>
        <div class="col-sm-3 col-md-12 col-lg-3 mt-2">
            <div class="custom-controls d-lg-flex d-md-flex flex-row justify-content-left">
                <label class="custom-control custom-checkbox ms-sm-2 md-md-2 ms-lg-2">
                    <input type="checkbox" class="custom-control-input" name="ads_reason" value="On vacation/business trip outside UAE" id="4">
                    <span class="custom-control-label">On vacation/business trip outside UAE</span>
                </label>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-md-3 col-lg-3">
            <label class="form-label">
                Other(s) please specify:
            </label>
        </div>
        <div class="col-sm-9 col-md-9 col-lg-9 mb-2">
            @Html.TextAreaFor(m => m.ads_reason_other, new { @class = "form-control", @placeholder = "please specify", @row = "4", @id = "ads_reason_other" })
        </div>
    </div>

    <div class="row">
        <div class="panel-heading bg-azure-light text-white font-weight-bold" role="alert"> 3. Medical Information(To be filled by treating doctor for all outpatient for cases like hospitalization procedures surgeries-detailed medical report is required)</div>
        <div class="col-sm-6 col-md-6 col-lg-6 mt-2">
            <label class="form-label">
                Condition Requiring treatment
            </label>
            @Html.TextAreaFor(m => m.ads_condition, new { @class = "form-control", @placeholder = "please specify", @row = "4", @id = "ads_condition" })
        </div>
        <div class="col-sm-6 col-md-6 col-lg-6 mt-2">
            <label class="form-label">
                Visit Date
            </label>
            <div class="input-group">
                <div class="input-group-prepend">
                    <div class="input-group-text">
                        <i class="fe fe-calendar"></i>
                    </div>
                </div>
                @Html.TextBoxFor(m => m.ads_visit, new { @class = "form-control", @placeholder = "DD-MMMM-YYYY", @id = "ads_visit" })
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <label class="form-label">
                Onset and duration of illness:
            </label>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12">
            @Html.TextAreaFor(m => m.ads_onset_duration, new { @class = "form-control", @placeholder = "Onset and duration of illness", @row = "2", @id = "ads_onset_duration" })
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12 mb-3">
            <label class="form-label">
                Treatment Details
            </label>

            @Html.TextAreaFor(m => m.ads_treat_details, new { @class = "form-control", @placeholder = "please specify", @row = "2", @id = "ads_treat_details" })
        </div>
    </div>


    <div class="row">
        <div class="col-sm-12 col-md-4 col-lg-4">
            <span class="text-capitalize text-left text-black">@emr.app_doctor_department&nbsp;</span>
        </div>
        <div class="col-sm-12 col-md-4 col-lg-4">
            <span class="text-capitalize text-left text-black">@emr.app_fdate&nbsp;</span>
        </div>
        <div class="col-sm-12 col-md-4 col-lg-4">
            <img alt="stamp" src="@emr.doc_sign" id="doc_sign" class="avatar avatar-xl bsquare" />
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-md-4 col-lg-4">
            <label class="form-label">
                Name of the Doctor
            </label>
        </div>
        <div class="col-sm-12 col-md-4 col-lg-4">
            <label class="form-label">
                Date
            </label>
        </div>
        <div class="col-sm-12 col-md-4 col-lg-4">
            <label class="form-label">
                Signature & Stamp
            </label>
        </div>
    </div>

    <div class="row panel-heading bg-azure-light text-white font-weight-bold">
        <div class="col-sm-6 col-md-6 col-sm-6 mt-2">
            4. Name & Address of the Hospital/Clinic
        </div>
        <div class="col-sm-6 col-md-6 col-sm-6 mt-2 ">
            Treatment Details
        </div>
    </div>

    <div class="row mt-2">
        <div class="col-sm-3 col-md-3 col-lg-3 ">
            <span class="text-capitalize text-left text-black">@emr.set_company&nbsp;</span>
        </div>
        <div class="col-sm-9 col-md-9 col-lg-9 ">
            <div class="table-responsive">
                <table id="tbl_Treatment" class="table table-striped table-bordered text-nowrap" style="width: 100%; cursor: pointer;">
                    <thead>
                        <tr style="color: #fff !important; background-color: #808080; border-color: #3C457D; ">
                            <th class="border-bottom-0 font-weight-semibold text-white">#</th>
                            <th class="border-bottom-0 font-weight-semibold text-white">CPT Code</th>
                            <th class="border-bottom-0 font-weight-semibold text-white">Treatment</th>
                            <th class="border-bottom-0 font-weight-semibold text-white">Type</th>
                            <th class="border-bottom-0 font-weight-semibold text-white">Price</th>
                            <th class="border-bottom-0 font-weight-semibold text-white">Auth. Code</th>
                            <th class="border-bottom-0 font-weight-semibold text-white">Auth. Date</th>
                            <th class="border-bottom-0 font-weight-semibold text-white">Exp. Date</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <label class="form-label">
                Currency(If treatment availed outside UAE)
            </label>
        </div>
    </div>

    <div class="row">
        <div class="panel-heading bg-azure-light text-white font-weight-bold" role="alert"> 5. Bank Details</div>

        <div class="col-sm-3 col-md-6 col-lg-3 mt-3">
            <label class="form-label">
                Bank Details(Compulsory):
            </label>
        </div>
        <div class="col-sm-3 col-md-6 col-lg-3  mt-2 ">
            @Html.TextBoxFor(m => m.ads_bankDetails, new { @class = "form-control", @placeholder = "Enter Details", @id = "ads_bankDetails", @width = "20px", @maxlength = "30" })
        </div>
        <div class="col-sm-3 col-md-3 col-lg-3 mt-2 ">
            <label class="form-label">

            </label>
        </div>
        <div class="col-sm-3 col-md-3 col-lg-3  mt-2">
            <label class="form-label">

            </label>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-md-6 col-lg-3 mt-3">
            <label class="form-label">
                Account Holder Name:
            </label>
        </div>
        <div class="col-sm-3 col-md-6 col-lg-3 mt-2 ">
            @Html.TextBoxFor(m => m.ads_account_holder, new { @class = "form-control", @placeholder = "Enter Holder Name ", @id = "ads_account_holder", @width = "20px", @maxlength = "30" })
        </div>
        <div class="col-sm-3 col-md-3 col-lg-3 ">
            <label class="form-label">

            </label>
        </div>
        <div class="col-sm-3 col-md-3 col-lg-3 ">
            <label class="form-label">

            </label>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-md-6 col-lg-3 mt-3">
            <label class="form-label">
                Bank Name:
            </label>
        </div>
        <div class="col-sm-3 col-md-6 col-lg-3 mt-2 ">
            @Html.TextBoxFor(m => m.ads_bank_name, new { @class = "form-control", @placeholder = "Enter Name", @id = "ads_bank_name", @width = "20px", @maxlength = "30" })
        </div>
        <div class="col-sm-3 col-md-3 col-lg-3 ">
            <label class="form-label">

            </label>
        </div>
        <div class="col-sm-3 col-md-3 col-lg-3 ">
            <label class="form-label">

            </label>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-md-6 col-lg-3 mt-3">
            <label class="form-label">
                Bank Address:
            </label>
        </div>
        <div class="col-sm-3 col-md-6 col-lg-3 mt-2 ">
            @Html.TextBoxFor(m => m.ads_bank_address, new { @class = "form-control", @placeholder = "Enter Address", @id = "ads_bank_address", @width = "20px", @maxlength = "30" })
        </div>
        <div class="col-sm-3 col-md-3 col-lg-3 ">
            <label class="form-label">

            </label>
        </div>
        <div class="col-sm-3 col-md-3 col-lg-3 ">
            <label class="form-label">

            </label>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-md-6 col-lg-3 mt-3">
            <label class="form-label">
                Currency:
            </label>
        </div>
        <div class="col-sm-3 col-md-6 col-lg-3 mt-2 mb-2">
            @Html.TextBoxFor(m => m.ads_bank_currency, new { @class = "form-control", @placeholder = "Enter Currency", @id = "ads_bank_currency", @width = "20px", @maxlength = "30" })
        </div>
        <div class="col-sm-3 col-md-6 col-lg-2  mt-3">
            <label class="form-label">
                SWIFT Code:
            </label>
        </div>
        <div class="col-sm-3 col-md-6 col-lg-4 mt-2 mb-2">
            @Html.TextBoxFor(m => m.ads_bank_swiftcode, new { @class = "form-control", @placeholder = "Enter SWIFT Code", @id = "ads_bank_swiftcode", @width = "20px", @maxlength = "30" })
        </div>
    </div>

    <div class="row">
        <div class="panel-heading bg-azure-light text-white font-weight-bold  mb-2" role="alert">  6. Other Information</div>
        <div class="col-sm-3 col-md-6 col-lg-3 mt-2">
            <label class="form-label">
                Is the above case work related
            </label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-2">
            <label class="form-label">
                @Html.RadioButtonFor(x => x.ads_oth_above, true) Yes
                @Html.RadioButtonFor(x => x.ads_oth_above, false) No
            </label>
        </div>
        <div class="col-sm-7 col-md-12 col-lg-7">
            <label class="form-label">
                (full details) @Html.TextAreaFor(m => m.ads_oth_above_det, new { @class = "form-control", @placeholder = "Enter full details", @row = "2", @id = "ads_oth_above_det" })
            </label>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-md-6 col-lg-3 mb-2">
            <label class="form-label">
                Is the claim covered by another insurance
            </label>
        </div>
        <div class="col-sm-12 col-md-6 col-lg-2 mb-2">
            <label class="form-label">
                @Html.RadioButtonFor(x => x.ads_oth_claim, true) Yes
                @Html.RadioButtonFor(x => x.ads_oth_claim, false) No
            </label>
        </div>
        <div class="col-sm-7 col-md-12 col-lg-7 mb-2">
            <label class="form-label">
                (Please specify the amount reimbursed and by which insurance company)@Html.TextAreaFor(m => m.ads_oth_claim_det, new { @class = "form-control", @placeholder = "Please specify", @row = "2", @id = "ads_oth_claim_det" })
            </label>
        </div>
    </div>

    <div class="row ">
        <div class="panel-heading bg-azure-light text-white font-weight-bold" role="alert"> 7. Declaration</div>
        <div class="col-sm-12 col-md-12 col-lg-12 mt-2">
            <p class="text-justify text-black">
                I, the undersigned hereby declared that the information above is true and complete and that reimbursement requested is for expense paid by me for the treatment of my medical condition.
            </p>
            <p class="text-justify text-black">
                I agree to submit to ADNIC any requested document mandatory / deemed necessary to process my above claim . I hereby authorize ADNIC to approach ,and any doctor / Medical facility/ any Institution or any person who has any record / medical information about me or my family member to provide ADNIC with complete information including copies of the records when requested.
            </p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-md-4 col-lg-3">
            @Html.TextBoxFor(m => m.ads_witnessname, new { @class = "form-control", @placeholder = "Enter Witness Name /Relationship", @id = "ads_witnessname", @width = "20px", @maxlength = "30" })
        </div>
        <div class="col-sm-3 col-md-2 col-lg-3">
            <div class="form-group mb-3" style="display:none" id="witimg"><img alt="Signature" src="" id="wit_sign" class="avatar avatar-xl bsquare" /></div>
        </div>
        <div class="col-sm-3 col-md-2 col-lg-3">
            <label class="form-label text-red text-left" id="psb_date_witness" name="">&nbsp;</label>
        </div>
        <div class="col-sm-3 col-md-4 col-lg-3">
            @Html.TextBoxFor(m => m.ads_contact, new { @class = "form-control", @placeholder = "Enter Contact No.", @id = "ads_contact", @width = "20px", @maxlength = "14" })
        </div>
    </div>
    <div class="row">
        <div class="col-sm-3 col-md-4 col-lg-3">
            <label class="form-label">
                Name Relationship to the Card Holder
            </label>
        </div>
        <div class="col-sm-3 col-md-2 col-lg-3">
            <label class="form-label">
                Signature
            </label>
        </div>
        <div class="col-sm-3 col-md-2 col-lg-3">
            <label class="form-label">
                Date
            </label>
        </div>
        <div class="col-sm-3 col-md-4 col-lg-3">
            <label class="form-label">
                Contact No.
            </label>
        </div>

    </div>
    <div class="row ">
        <div class="panel-heading bg-azure-light text-white font-weight-bold" role="alert"> Instructions</div>
    </div>
    <div class="row ">
        <div class="card-body ps-5 pe-5">
            <ul class="list-style2 text-justify text-black">
                <li>This form needs to be completed by the insured member (Card holder), only if the provider is not submitting the claim on his behalf.</li>
                <li>Please read the form carefully and make sure to complete all pertinent information. ADNIC will not be able to process any incomplete Reimbursement Claim Form with lacking proper documentation.</li>
                <li>Use a separate form for each Member.</li>
                <li>All the documents including invoices and medical reports should be in either English or Arabic. Documents in other languages must be translated by an official public translator prior to submission.</li>
                <li>
                    The following documents to be attached to your duly filled Reimbursement Claim Form.
                    <ol style="list-style-type:disc;">
                        <li>Copy of Card.</li>
                        <li>Original itemized bill/Invoices (dated) and receipts of payment.</li>
                        <li>Original prescription for medication given by the treating doctor ( except for controlled drugs) . Validity of the prescription is limited to 60 days and for controlled drugs is limited to 3 days in line with HAAD</li>
                        <li>Investigation requests/reports like laboratory tests, x-rays, etc.</li>
                    </ol>
                    Additional requirements to above:<br />
                    For Inpatient (Hospitalization Cases)
                    <ol style="list-style-type:disc;">
                        <li>Medical Report/Discharge Summary stamped & signed by the treating Doctor.</li>
                    </ol>
                    For treatment availed Outside the UAE
                    <ol style="list-style-type:disc;">
                        <li>Copy of passport showing Exit & Re-entry to UAE or any other similar documents (E.g.: E-gate)</li>
                        <li>Elective treatment is subject to ADNIC prior approval at all times.</li>
                    </ol>
                </li>
                <li>Please retain copies of receipts and documents enclosed with your claim, as ADNIC will retain original documents.</li>
                <li>All claims s ubject to reimbursement availed within or outside UAE should be submitted within 120 days of incurred treatment.</li>
                <li>
                    Please submit all the above required documents directly to MSH international - DIFC Liberty House Office No 304, Level - 3, P.O Box 506537, Dubai, United Arab Emirates<br />
                    If you need assistance in filling this form please call MSH Toll Free (UAE): 800674823|+971 4 365 1350
                </li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="panel-heading bg-azure-light text-white font-weight-bold" role="alert">  Instructions to complete the Form</div>
    </div>
    <div class="row ">
        <div class="card-body ps-5 pe-5">
            <ul class="list-style2 text-justify text-black">
                <li>Please write your name & Card Number as mentioned in the Card</li>
                <li>Medical Information – Request your treating doctor to fill up brief medical information about your condition and treatment.</li>
                <li>Provider Name & Address – Kindly use more than one line if necessary to provide this information about each facility where  you were treated.</li>
                <li>Bill No. – Please write the serial number/reference number printed on the bill/receipt/invoice for each service separately.</li>
                <li>Service Date – State date of treatment for each service against each bill.</li>
                <li>Description of Services –State type of service like Consultation/Pharmacy/Investigations/Physiotherapy/Dental/ Hospitalization.</li>
                <li>Amount – State the exact amount as appears on the invoices</li>
                <li>Total – Total amount of all the invoices submitted with this form for reimbursement from ADNIC</li>
                <li>Currency – Name of the currency in which actual payment was made.</li>
                <li>If treatment due to road traffic accident a police report is required to be submitted with this form.</li>
                <li>Declaration – Kindly write your name, signature, date, the contact number and relationship to the cardholder.</li>

            </ul>
        </div>
    </div>
    <div class="row">
        <div class="row mt-2">
            <div class="col-sm-12 col-md-12 col-lg-12 text-center">
                <div class="btn-list btn-animation">
                    <button type="submit" class="btn btn-success btn-sm" id="btn_Insert_Adnic">Save</button>
                    <button type="button" class="btn btn-outline-dark btn-sm" id="btn_Reset_Adnic">Reset</button>
                    <div class="btn-group mr-2">
                        <div class="dropdown">
                            <button type="button" class="btn-sm btn-secondary me-2 mb-2 dropdown-toggle" data-bs-toggle="dropdown">
                                <i class="fa fa-paint-brush">&nbsp;&nbsp;</i> Patient
                            </button>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" onclick="openSignaturePad('patient')">Tab</a>
                                <a class="dropdown-item" onclick="openWacomTabSignaturePad('patient')">Wacom Tab</a>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="btn btn-outline-danger me-1" id="btn_Close_Adnic" style="display:none">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
</form>

<script type="text/javascript">

    //#region Page Load
        var formName1 = $(form_AdnicDecision).closest('form').attr('name');
        $(function () {
            Get_Patient_Complaints();
            Get_Patient_Treatments();
            Get_AllPatientTreatments();
            validate();
            $('#ads_visit').bootstrapdatepicker({
                 format: "dd-MM-yyyy",
                 viewMode: "date",
                 todayHighlight: true,
                 autoclose: true,
                 multidate: false,
                 multidateSeparator: "-"
             });
            $("#ads_visit").bootstrapdatepicker("setDate", moment(new Date("@Model.ads_visit")).format("DD-MMMM-YYYY"));
        });
    //#endregion

    //#region Complaints

        var Get_Patient_Complaints = function () {
        $.ajax({
            type: "GET",
            url: "@Url.Action("Get_Patient_Complaints", "ReimbursementForms", new { area = "EMRForms" })?appId=" + "@emr.appId" + "&patId=" + @emr.patId,
            success: function (response) {
                if (response.length > 0) {
                    var down = document.getElementById('ads_condition');
                    var str2 = response[0].complaints;
                    var regex = /(|<([^>]+)>)/ig;
                    down.innerHTML = str2.replace(/(<p>|<\/p>)/g, "");
                }
            },
            error: function (xhr) {
                console.log(xhr);
            }
        });
    }
    //#endregion

    //#region Get_Patient_Treatments
        var Get_Patient_Treatments = function () {
            $.ajax({
                type: "GET",
                url: "@Url.Action("Get_Patient_Treatment", "ReimbursementForms", new { area = "EMRForms" })?appId=" +@emr.appId,
                success: function (response) {
                    if (response.length > 0) {
                        $('#ads_treat_details').text(response[0].treatments);
                    }
                },
                error: function (xhr) {
                    console.log(xhr);
                }
            });
        }
    //#endregion

    //#region Load Get_Patient_Treatments_table
        var Get_AllPatientTreatments = function () {

            $.ajax({
                type: "GET",
                url: "@Url.Action("GetAllPatientTreatments", "ReimbursementForms", new { area = "EMRForms" })?appId=" + "@emr.appId" + "&patId=" + @emr.patId,
                success: function (response) {
                    if (response.isAuthorized != false) {
                        var table;
                        if ($.fn.dataTable.isDataTable('#tbl_Treatment')) {
                            table = $('#tbl_Treatment').DataTable();
                            table.clear();
                            table.rows.add(response).draw();
                        }
                        else {
                            BindDataTableP(response);
                        }
                    }
                    else {
                        console.log("You are not Authorized!");
                    }
                },
                error: function (xhr) {
                    console.log(xhr);
                }
            })
        }
    //#endregion Load Get_Patient_Treatments_table

    //#region Bind Get_Patient_Treatments_table
        var BindDataTableP = function (response) {
            var table = $("#tbl_Treatment").DataTable({
                fixedHeader: {
                    header: true,
                    footer: true
                },
                processing: true,
                "deferRender": true,
                "retrieve": true,
                lengthChange: true,
                "aaData": response,
                "aoColumns": [
                    {
                        "mData": "ptId",
                        "orderable": false,
                        "searchable": false,
                        "className": "text-center",
                        "render": function (data, type, row, meta) {
                            let _index = (meta.row) + 1;
                            if (_index >= 10) {
                                return "<a href='javascript:void(0)' class='fs-13 font-weight-bold'>" + _index + "</a>";
                            }
                            else {
                                return "<a href='javascript:void(0)' class='fs-13 font-weight-bold'>0" + _index + "</a>";
                            }
                        }
                    },


                    {
                        "mData": "tr_code",
                        "className": 'text-justify'
                    },
                    {
                        "mData": "tr_name",
                        "className": 'text-justify text-wrap'
                    },
                    {
                        "mData": "tr_type",
                        "className": 'text-justify'
                    },

                    {
                         "mData": "tr_price",
                        "className": 'text-justify'
                    },
                    {
                         "mData": "pt_auth_code",
                        "className": 'text-justify'
                    },
                    {
                        "mData": "pt_auth_adate",
                        "className": "text-left",
                        "render": function (data, type, row, meta) {
                            if (type === 'display' || type === 'filter') {
                                return moment(data).format("DD-MM-YYYY");
                            }
                            return moment(data).format("YYYY-MM-DD");
                        }
                    },
                    {
                        "mData": "pt_auth_edate",
                        "className": "text-left",
                        "render": function (data, type, row, meta) {
                            if (type === 'display' || type === 'filter') {
                                return moment(data).format("DD-MM-YYYY");
                            }
                            return moment(data).format("YYYY-MM-DD");
                        }
                    },

                ],
                order: [[0, 'asc']],
                scrollX: true,
                scrollY: 500,
                scrollCollapse: true,

            });

        };
    //#endregion Previous Bind Datatable

    //#region Validation Initialization
        var validate = function () {
            $("#form_AdnicDecision").validate({
                rules: {
                    ads_group_mem: {
                        required: true
                    },

                },
                messages: {
                    ads_group_mem: {
                        required: "Please Enter Group Member Name!"
                    },

                },
                highlight: function (element) {
                    var elem = $(element);
                    $(element).parent().addClass('has-error');
                    //error_timeout(elem.attr("id"));
                },
                unhighlight: function (element) {
                    var elem = $(element);
                    $(element).parent().removeClass('has-error');
                },
                errorElement: 'span',
                errorClass: 'text-danger fw-bold',
                errorPlacement: function (error, element) {
                    var elem = $(element);
                    if (element.parent('.input-group').length) {
                        error.insertAfter(element.parent());
                    } else {
                        error.insertAfter(element);
                    }
                }
            });
            $('#ads_contact').keypress(function (e) {
                var charCode = (e.which) ? e.which : e.keyCode
                var inputValue = $(this).val() + String.fromCharCode(charCode);

                if (String.fromCharCode(charCode).match(/[^0-9.]/g)) {
                    return false;
                }
            });
            $('#ads_visit').keypress(function (e) {
                var charCode = (e.which) ? e.which : e.keyCode
                if (String.fromCharCode(charCode).match(/[^0-9./-]/g)) {
                    return false;

                }
                else {
                    if (e.target.value.length >= 18)
                        return false;
                }
            });

        }
    //#endregion

    //#region Insert Button Click
    $('#btn_Insert_Adnic').on('click', function (e) {
        e.preventDefault();

        if ($("#form_AdnicDecision").valid()) {
            $('#btn_Insert_Adnic').removeClass("btn btn-success");
            $('#btn_Insert_Adnic').addClass("btn btn-success btn-loaders btn-icon");
            $('#btn_Insert_Adnic').html("Saving the Record....");
            var ads_reason = $.map($(':checkbox[name=ads_reason]:checked'), function (n, i) {
                return n.value;
            }).join(',');

            var _dataInsert = {
                "adsId": 0,
                "ads_appId": @emr.appId,
                "ads_reason": ads_reason,
                "ads_voucher": $("#ads_voucher").val(),
                "ads_group_mem": $("#ads_group_mem").val(),
                "ads_type_plan": $("#ads_type_plan").val(),
                "ads_reason_other": $("#ads_reason_other").val(),
                "ads_condition": $("#ads_condition").val(),
                "ads_visit": moment($("#ads_visit").val()).format("YYYY-MM-DD"),
                "ads_treat_details": $("#ads_treat_details").val(),
                "ads_addr1":'',
                "ads_bill1": '',
                "ads_tdate1": '',
                "ads_desc1": '',
                "ads_amt1": '',

                "ads_addr2": '',
                "ads_bill2": '',
                "ads_tdate2": '',
                "ads_desc2": '',
                "ads_amt2": '',

                "ads_addr3": '',
                "ads_bill3": '',
                "ads_tdate3": '',
                "ads_desc3": '',
                "ads_amt3": '',

                "ads_addr4": '',
                "ads_bill4": '',
                "ads_tdate4": '',
                "ads_desc4": '',
                "ads_amt4": '',

                "ads_addr5": '',
                "ads_bill5": '',
                "ads_tdate5": '',
                "ads_desc5": '',
                "ads_amt5": '',
                "ads_total": '',
                "ads_oth_above": $('input[name=ads_oth_above]:checked').val(),
                "ads_oth_claim": $('input[name=ads_oth_claim]:checked').val(),
                "ads_oth_above_det": $("#ads_oth_above_det").val(),
                "ads_oth_claim_det": $("#ads_oth_claim_det").val(),
                "ads_onset": $("#ads_onset_duration").val(),
                "ads_bank": $("#ads_bankDetails").val(),
                "ads_account": $("#ads_account_holder").val(),
                "ads_bname": $("#ads_bank_name").val(),
                "ads_baddress": $("#ads_bank_address").val(),
                "ads_bcurrency": $("#ads_bank_currency").val(),
                "ads_bswiftcode": $("#ads_bank_swiftcode").val(),
                "ads_witnessname": $("#ads_witnessname").val(),
                "ads_contact": $("#ads_contact").val(),
                "__RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val()
            }

            $.ajax({
                type: "POST",
                url: "@Url.Action("InsertAdnic", "ReimbursementForms", new { area = "EMRForms" })",
                dataType: 'JSON',
                data: _dataInsert,
                success: function (data) {
                    $('#btn_Insert_Adnic').removeClass("btn btn-success btn-loaders btn-icon");
                    $('#btn_Insert_Adnic').addClass("btn btn-success");
                    $('#btn_Insert_Adnic').html("Add");

                    if (data.isSuccess) {
                        if (data.isInserted) {
                            GetAdnic();
                            var alertPlaceholder = document.getElementById("Alert");
                            function alert(e, t) {
                                var l = document.createElement("div");
                                l.innerHTML = '<div class="alert alert-' + t + ' alert-dismissible" role="alert">' + e +
                                    '<button type="button" class="btn-close" data-bs-dismiss="alert" aria-hidden="Close">x</button></div>', alertPlaceholder.append(l)
                            }
                            alert("<i class='fe fe-check-circle text-white'></i> Adnic Claim Form Added Successfully!", "success");
                            Timeout();

                        }
                        else {
                            let html = "<div class='col-12 col-sm-12 col-md-12 d-flex justify-content-center'>" +
                                "<div class='alert alert-light-warning' role='alert'>" +
                                "<button type='button' class='btn-close text-warning' style='margin-bottom:-5px;' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                                "<strong><i class='fa fa-exclamation-triangle text-warning'></i> Adnic Claim Form Alredy Exists!</strong><br/>" +
                                "</div></div>";
                            $("#error").html(html);
                        }
                    }
                    else {
                        let html = "<div class='col-12 col-sm-12 col-md-12 d-flex justify-content-center'>" +
                            "<div class='alert alert-light-danger' role='alert'>" +
                            "<button type='button' class='btn-close text-danger' style='margin-bottom:-5px;' data-bs-dismiss='alert' aria-hidden='true' aria-label='Close'>×</button>" +
                            "<strong><i class='fa fa-ban text-danger'></i> Validation Error! Please validate before submitting.&nbsp;</strong><br/><ul>";

                        $.each(data.message, function (index, value) {
                            html += "<li><small>" + value + "</small><li>";
                            var elem = $("#" + index);
                            if (elem.hasClass("select2-hidden-accessible")) {
                                $("#select2-" + elem.attr("id") + "-container").parent().addClass('error');
                            }
                            else {
                                $(elem).addClass(" is-invalid");
                            }

                            setTimeout(function () {
                                if (elem.hasClass("select2-hidden-accessible")) {
                                    $("#select2-" + elem.attr("id") + "-container").parent().removeClass('error');
                                }
                                else {
                                    $(elem).removeClass("is-invalid");
                                }
                            }, 5000);
                        });
                        html += "</ul></div></div>";
                        $("#error").html(html);
                    }
                },
                error: function (xhr) {
                    $('#btn_Insert_Adnic').removeClass("btn btn-success btn-loaders btn-icon");
                    $('#btn_Insert_Adnic').addClass("btn btn-success");
                    $('#btn_Insert_Adnic').html("Add");
                    Timeout();
                }
            });
        }
        else {
            $('.card-body').animate({
                scrollTop: ($('.has-error').offset().top - 300)
            }, 2000);
        }
    });
    //#endregion

    //#region Wacom Tab Signature
        var openWacomTabSignaturePad = function (id) {
            var _data = {
                "patId": @emr.patId,
                "person": id,
                "form": formName1,
                "appId": @emr.appId,
                "formname":"Adnic",
                "formlink":"PrintAdnicClaim.aspx",
                "eSign":""
            }
            $.ajax({
                type: "GET",
                url: "@Url.Action("WacomTabSignaturePad", "WacomTabSignaturePad", new { area = "Common" })",
                contentType: "application/json",
                dataType: "html",
                data: _data,
                success: function (response) {
                    $("#signature_pad_body").html(response);
                    $("#signature_pad").modal("show");
                },
                error: function (xhr) {
                    console.log("Error :" + xhr.statusText);
                }
            });
        }
    //#endregion

    //#region Signature
        var openSignaturePad = function (id) {
            var _data = {
                "patId": @emr.patId,
                "person": id,
                "form": formName1,
                "appId": @emr.appId,
                "formname":"Adnic",
                "formlink":"PrintAdnicClaim.aspx",
                "eSign":""
            }
            $.ajax({
                type: "GET",
                url: "@Url.Action("SignaturePad", "SignaturePad", new { area = "Common" })",
                contentType: "application/json",
                dataType: "html",
                data: _data,
                success: function (response) {
                    $("#signature_pad_body").html(response);
                    $("#signature_pad").modal("show");
                },
                error: function (xhr) {
                    console.log("Error :" + xhr.statusText);
                }
            });
        }
    //#endregion Signature

    //#region Reset
        $('#btn_Reset_Adnic').on('click', function (e) {
            e.preventDefault();
            clearControls();
        });
    //#endregion Reset

    //#region Clear Controls
        var clearControls = function () {
            $("#uads_voucher").val("");
            $("#uads_group_mem").val("");
            $("#ads_type_plan").val("");
            $("#ads_reason_other").val("");
            $("#ads_condition").val("");
            $("#ads_treat_details").val("");
            $("#ads_oth_above_det").val("");
            $("#ads_oth_claim_det").val("");
            $("#ads_onset_duration").val("");
            $("#ads_bankDetails").val("");
            $("#ads_account_holder").val("");
            $("#ads_bank_name").val("");
            $("#ads_bank_address").val("");
            $("#ads_bank_currency").val("");
            $("#ads_bank_swiftcode").val("");
            $("#ads_witnessname").val("");
            $("#ads_contact").val("");
            $('input[name=ads_oth_above]').prop('checked', false);
            $('input[name=ads_oth_claim]').prop('checked', false);
        }
    //#endregion Clear Controls



</script>
